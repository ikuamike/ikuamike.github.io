<!doctype html><html lang=en><head><title>Grayhat Red Team Village CTF 2020 WriteUp: Tunneler :: ikuamike</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content=","><meta name=robots content="noodp"><link rel=canonical href=https://blog.ikuamike.io/posts/2020/grayhat_red_team_village_ctf_tunneler_writeup/><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-202973704-2","auto"),ga("send","pageview"))</script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-202973704-2","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script><meta name=twitter:card content="summary"><meta name=twitter:title content="Grayhat Red Team Village CTF 2020 WriteUp: Tunneler"><meta name=twitter:description content><meta name=twitter:site content="@ikuamike"><link rel=stylesheet href=https://blog.ikuamike.io/styles.css><link rel=stylesheet href=https://blog.ikuamike.io/css/style.css><link rel="shortcut icon" href=https://blog.ikuamike.io/img/theme-colors/green.png><link rel=apple-touch-icon href=https://blog.ikuamike.io/img/theme-colors/green.png><meta name=twitter:card content="summary_large_image"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Grayhat Red Team Village CTF 2020 WriteUp: Tunneler"><meta property="og:description" content><meta property="og:url" content="https://blog.ikuamike.io/posts/2020/grayhat_red_team_village_ctf_tunneler_writeup/"><meta property="og:site_name" content="ikuamike"><meta property="og:image" content="https://blog.ikuamike.io/"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><meta property="article:published_time" content="2020-11-01 00:00:00 +0000 UTC"></head><div id=particles-js></div><body class=green><div class="container center headings--one-size" style=background:#1f222a;z-index:1><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>> cd ~</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/about>About Me</a></li><li><a href=/all-posts>All Posts</a></li><li><a href=/tags>Tags</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/about>About Me</a></li><li><a href=/all-posts>All Posts</a></li><li><a href=/tags>Tags</a></li></ul></nav></header><div class=content><article class=post><h1 class=post-title><a href=https://blog.ikuamike.io/posts/2020/grayhat_red_team_village_ctf_tunneler_writeup/>Grayhat Red Team Village CTF 2020 WriteUp: Tunneler</a></h1><div class=post-meta><time class=post-date>2020-11-01 ::</time></div><span class=post-tags>#<a href=https://blog.ikuamike.io/tags/ctf/>CTF</a>&nbsp;
#<a href=https://blog.ikuamike.io/tags/ssh/>SSH</a>&nbsp;
#<a href=https://blog.ikuamike.io/tags/tunneling/>Tunneling</a>&nbsp;</span><div class=table-of-contents><h2>Table of Contents</h2><nav id=TableOfContents><ul><li><a href=#summary>Summary</a></li><li><a href=#1-bastion>1. Bastion</a></li><li><a href=#2-browsing-websites>2. Browsing Websites</a></li><li><a href=#3-ssh-in-tunnels>3. SSH in tunnels</a></li><li><a href=#4-beacons-everywhere>4. Beacons Everywhere</a></li><li><a href=#5-beacons-annoying>5. Beacons Annoying</a></li><li><a href=#6-scan-me>6. Scan me</a></li><li><a href=#7-another-pivot>7. Another Pivot</a></li><li><a href=#8-snmp>8. SNMP</a></li><li><a href=#9-samba>9. Samba</a></li><li><a href=#10-browsing-website-2>10. Browsing website 2</a></li><li><a href=#conclusion>Conclusion</a></li><li><a href=#resources>Resources</a></li></ul></nav></div><div class=post-content><div><h2 id=summary>Summary<a href=#summary class=hanchor arialabel=Anchor>&#8983;</a></h2><p>During Grayhat Conference the Red Team Village hosted a beginner/intermediate CTF. Our CTF team fr334aks decided
to participate as we enjoyed the previous CTF created by them during DEFCON. I tackled the Tunneler challenges
that were exactly the same as the previous CTF. So with the less pressure it was a nice opportunity to make a writeup for
ssh tunneling techniques.</p><p>I am writing this to serve as a personal reference for ssh tunneling as it has a very good practical aspect to use as an example. I will show different
ways these challenges could have been solved.</p><h2 id=1-bastion>1. Bastion<a href=#1-bastion class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Challenge description:</p><pre tabindex=0><code>Connect to the bastion host 104.131.101.182

User: tunneler 
Password: tunneler 
SSH Port: 2222
</code></pre><p>Solution:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>ssh tunneler@104.131.101.182 -p <span style=color:#ae81ff>2222</span>
</span></span></code></pre></div><p>Once we ssh in, we get the following welcome message and also the bastion host is connected to multiple networks. We don&rsquo;t see the ip we used to ssh in as
we are droppped in a docker container.</p><img src=/img/grayhat_2020/screenshot1.png alt=grayhat_redteam_ctf class=center style=border-radius:8px><h2 id=2-browsing-websites>2. Browsing Websites<a href=#2-browsing-websites class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Challenge Description:</p><pre tabindex=0><code>Browse to http://10.174.12.14/
</code></pre><p>This challenge requires a local port forward.</p><p>Solution 1:</p><p>Using ssh command.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>ssh tunneler@104.131.101.182 -p <span style=color:#ae81ff>2222</span> -L 8000:10.174.12.14:80
</span></span></code></pre></div><p>Then use curl to reach the website.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>curl 127.0.0.1:8000
</span></span></code></pre></div><p>Solution 2:</p><p>Using ssh config and add <code>LocalForward</code> entry.</p><pre tabindex=0><code>Host bastion
 Hostname 104.131.101.182
 User tunneler
 Port 2222
 LocalForward 8000 10.174.12.14:80
</code></pre><p>Then ssh into bastion and run curl as above.</p><p>Solution 3:</p><p>Running sshuttle to add a route to the target ip, this utilizes the ssh config for bastion without the localforward entry.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>sshuttle -r bastion 10.174.12.14/32
</span></span></code></pre></div><p>The beauty about this one is that I can reach the ip directly now.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>curl 10.174.12.14
</span></span></code></pre></div><img src=/img/grayhat_2020/screenshot2.png alt=grayhat_redteam_ctf class=center style=border-radius:8px><h2 id=3-ssh-in-tunnels>3. SSH in tunnels<a href=#3-ssh-in-tunnels class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Challenge Description:</p><pre tabindex=0><code>SSH through the bastion to the pivot.

IP: 10.218.176.199 
User: whistler 
Pass: cocktailparty
</code></pre><p>For this challenge we need to jump through the bastion host and access the pivot.</p><p>Solution 1:</p><p>Using the <code>-J</code> option in ssh command, this sets up a proxyjump.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>ssh -J tunneler@104.131.101.182:2222 whistler@10.218.176.199
</span></span></code></pre></div><p>Solution 2:</p><p>Using ssh config, this builds on the config we started with in the previous challenge and uses <code>ProxyJump</code>.</p><pre tabindex=0><code>Host pivot1
 Hostname 10.218.176.199
 User whistler
 ProxyJump bastion
</code></pre><p>Then all we need to do is run the following command and see that pivot1 is also connected to more than one network.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>ssh pivot1
</span></span></code></pre></div><img src=/img/grayhat_2020/screenshot3.png alt=grayhat_redteam_ctf class=center style=border-radius:8px><h2 id=4-beacons-everywhere>4. Beacons Everywhere<a href=#4-beacons-everywhere class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Challenge Description:</p><pre tabindex=0><code>Something is Beaconing to the pivot on port 58671-58680 
to ip 10.112.3.199, can you tunnel it back?

NOTE: IT IS THE SAME ON EACH PORT ONLY USE ONE PORT 
AND REMOVE YOUR TUNNEL WHEN YOU ARE DONE
</code></pre><p>For this challenge we need to achieve a remote port forward.</p><p>Solution 1:</p><p>Using ssh command. First we proxyjump then perform the remote port forward.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>ssh -J tunneler@104.131.101.182:2222 whistler@10.218.176.199 -R 10.112.3.199:58671:127.0.0.1:5000
</span></span></code></pre></div><p>Then on another terminal window, open a netcat listener.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>nc -lvnp <span style=color:#ae81ff>5000</span>
</span></span></code></pre></div><p>Solution 2:</p><p>Using ssh config. For this I&rsquo;ll add a <code>RemoteForward</code> option under pivot1.</p><pre tabindex=0><code>Host pivot1
 Hostname 10.218.176.199
 User whistler
 ProxyJump bastion
 RemoteForward 58671 127.0.0.1:5000
</code></pre><p>Then we just run <code>ssh pivot1</code> and open a netcat listener.</p><img src=/img/grayhat_2020/screenshot4.png alt=grayhat_redteam_ctf class=center style=border-radius:8px><h2 id=5-beacons-annoying>5. Beacons Annoying<a href=#5-beacons-annoying class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Challenge Description:</p><pre tabindex=0><code>Connect to ip: 10.112.3.88 port: 7000, a beacon awaits you
</code></pre><p>This challenge needs a local port forward and a remote port forward.</p><p>Solution:</p><p>Using ssh command, here we proxyjump and then forward localport 7000 to our target at port 7000.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>ssh -J tunneler@104.131.101.182:2222 whistler@10.218.176.199 -L 7000:10.112.3.88:7000
</span></span></code></pre></div><p>Then connect using netcat.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>nc -vn 127.0.0.1 <span style=color:#ae81ff>7000</span>
</span></span></code></pre></div><img src=/img/grayhat_2020/screenshot5.png alt=grayhat_redteam_ctf class=center style=border-radius:8px><p>Next step is using a reverse port forward to receive the flag, we need to be quick to set the port as the flag is sent after 15s.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>ssh -J tunneler@104.131.101.182:2222 whistler@10.218.176.199 -R 10.112.3.199:17172:127.0.0.1:6000
</span></span></code></pre></div><p>Then on another terminal open a listener on port 6000.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>nc -vn 127.0.0.1 <span style=color:#ae81ff>6000</span>
</span></span></code></pre></div><img src=/img/grayhat_2020/screenshot6.png alt=grayhat_redteam_ctf class=center style=border-radius:8px><p>It was an annoying beacon indeed, we needed 4 terminal panes open (I use tmux).</p><h2 id=6-scan-me>6. Scan me<a href=#6-scan-me class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Challenge Description:</p><pre tabindex=0><code>We deployed a ftp server but we forgot which port, find it and connect

ftp: 10.112.3.207 user: bishop pass: geese
</code></pre><p>For this challenge we need to perform a portscan then a local portforward. However, port scanning over a tunnel can be quite slow
or sometimes fail. I ended up uploading an nmap binary to pivot1 and then scan the target.</p><p>Solution:</p><p>Building on the previous ssh config, I&rsquo;ll use scp to upload nmap. Nmap needs a services file to run, we need to upload that as well. Then from pivot1
we can perform a full portscan.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>scp /opt/nmap-7.91SVN-x86_64-portable/nmap pivot1:/tmp
</span></span><span style=display:flex><span>scp /opt/nmap-7.91SVN-x86_64-portable/data/nmap-services pivot1:/tmp
</span></span><span style=display:flex><span>./nmap --datadir /tmp -p- 10.112.3.207
</span></span></code></pre></div><img src=/img/grayhat_2020/screenshot7.png alt=grayhat_redteam_ctf class=center style=border-radius:8px><p>After getting the port, let&rsquo;s use sshuttle to add a route to the ftp server.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>sshuttle -r pivot1 10.112.3.207/32
</span></span></code></pre></div><p>Next is to just connect to the ftp server, the flag was in the banner.</p><img src=/img/grayhat_2020/screenshot8.png alt=grayhat_redteam_ctf class=center style=border-radius:8px><h2 id=7-another-pivot>7. Another Pivot<a href=#7-another-pivot class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Challenge Description:</p><pre tabindex=0><code>Connect to the second pivot

IP: 10.112.3.12 
User: crease 
Pass: NoThatsaV
</code></pre><p>More proxyjumps.</p><p>Solution 1:</p><p>Multiple proxyjumps can be separated by a comma.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>ssh -J tunneler@104.131.101.182:2222,whistler@10.218.176.199 crease@10.112.3.12
</span></span></code></pre></div><p>Solution 2:</p><p>I&rsquo;ll update ssh config with this new pivot.</p><pre tabindex=0><code>Host pivot2
 Hostname 10.112.3.12
 User crease
 ProxyJump pivot1
</code></pre><p>Then run</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>ssh pivot2
</span></span></code></pre></div><p>This host is connected to multiple networks and it seems portforwarding is disabled here, therefore we&rsquo;ll have some fun with socat!</p><img src=/img/grayhat_2020/screenshot9.png alt=grayhat_redteam_ctf class=center style=border-radius:8px><h2 id=8-snmp>8. SNMP<a href=#8-snmp class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Challenge Description:</p><pre tabindex=0><code>There is a snmp server at 10.24.13.161
</code></pre><p>This challenge is interesting because snmp runs over udp, you can&rsquo;t really create a udp tunnel. We&rsquo;ll tunnel udp inside a tcp tunnel.
Since in pivot2 tunneling is disabled we&rsquo;ll use socat.</p><p>Solution:</p><p>First we ssh into pivot2 then open a tcp listener which redirects traffic to udp out to snmp.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>socat TCP4-LISTEN:5000,fork UDP4:10.24.13.161:161
</span></span></code></pre></div><p>Next we open a local portforward through pivot1 to the tcp port on pivot2 we opened above, I&rsquo;ll use the full ssh command here.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>ssh -J tunneler@104.131.101.182:2222 whistler@10.218.176.199 -L 5000:10.112.3.12:5000
</span></span></code></pre></div><p>Then on our local machine we use socat again to redirect from local udp 161 to local port 5000 that would be forwarded by the above tunnel.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>sudo socat UDP4-LISTEN:161,fork TCP:localhost:5000
</span></span></code></pre></div><p>Then finally we run snmpwalk against localhost and the traffic is forwarded through the long tunnel created.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>snmpwalk -v1 -c public localhost
</span></span></code></pre></div><img src=/img/grayhat_2020/screenshot10.png alt=grayhat_redteam_ctf class=center style=border-radius:8px><h2 id=9-samba>9. Samba<a href=#9-samba class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Challenge Description:</p><pre tabindex=0><code>There is a samba server at 10.24.13.10, find a flag sitting in the root file system /

nothing to find in the shares
</code></pre><p>Similar to the snmp one above we&rsquo;ll use socat to tunnel to the samba server.</p><p>Solution:</p><p>First we ssh into pivot2 and use socat to redirect traffic</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>socat -v TCP-LISTEN:5000,fork TCP:10.24.13.10:445
</span></span></code></pre></div><p>Then perform a local portforward through pivot1 to pivot2</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>ssh -J tunneler@104.131.101.182:2222 whistler@10.218.176.199 -L 5000:10.112.3.12:5000
</span></span></code></pre></div><p>Based on the challenge description, we need to access the root file system and nothing is in the shares. Sounds like
we need to exploit it as there&rsquo;s no other way to access the root file system.</p><p>Solution:</p><p>Run nmap to find the samba version and check for exploit in exploitdb using searchsploit.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>nmap -sC -sV -p <span style=color:#ae81ff>5000</span> 127.0.0.1
</span></span><span style=display:flex><span>searchsploit samba
</span></span></code></pre></div><img src=/img/grayhat_2020/screenshot11.png alt=grayhat_redteam_ctf class=center style=border-radius:8px><p>There are several metasploit exploits listed for samba therefore we&rsquo;ll use it.
The exploit that worked is <code>exploit/linux/samba/is_known_pipename</code> and we get the flag.</p><img src=/img/grayhat_2020/screenshot12.png alt=grayhat_redteam_ctf class=center style=border-radius:8px><h2 id=10-browsing-website-2>10. Browsing website 2<a href=#10-browsing-website-2 class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Challenge Description:</p><pre tabindex=0><code>Browse to http://2a02:6b8:b010:9010:1::86/
</code></pre><p>This challenge shows portforwarding from ipv4 to ipv6. We&rsquo;ll use socat too on this one.</p><p>Solution:</p><p>First we ssh into pivot1 then use socat to redirect traffic from ipv4 to ipv6.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>socat -v TCP-LISTEN:5000,fork TCP6:<span style=color:#f92672>[</span>2a02:6b8:b010:9010:1::86<span style=color:#f92672>]</span>:80
</span></span></code></pre></div><p>Then forward local port 5000 through pivot1 to pivot 2</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>ssh pivot1 -L 5000:10.112.3.12:5000
</span></span></code></pre></div><p>Then make the web request to local port 5000 which will be forwarded through the tunnel created.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>curl localhost:5000
</span></span></code></pre></div><img src=/img/grayhat_2020/screenshot13.png alt=grayhat_redteam_ctf class=center style=border-radius:8px><p>The final base ssh config looked like this without the port forwards:</p><pre tabindex=0><code>Host bastion
 Hostname 104.131.101.182
 User tunneler
 Port 2222

Host pivot1
 Hostname 10.218.176.199
 User whistler
 ProxyJump bastion

Host pivot2
 Hostname 10.112.3.12
 User crease
 ProxyJump pivot1
</code></pre><h2 id=conclusion>Conclusion<a href=#conclusion class=hanchor arialabel=Anchor>&#8983;</a></h2><p>There are several techniques to make your tunneling much easier, for quick use like in a ctf I think crafting the full ssh command is better and
faster. For frequent connection, using sshuttle combined with a good ssh config can make your life much easier.</p><p>After all those connections here&rsquo;s a Network Diagram that visualizes the access we were able to achieve with the tunnels:</p><img src=/img/grayhat_2020/Tunneler.png alt=grayhat_redteam_ctf class=center style=border-radius:8px><p>Here&rsquo;s a nice writeup by <a href=https://twitter.com/Rayhan0x01 target=_blank rel=noopener>@Rayhan0x01</a>
on how he used a different approach using metasploit:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>https://rayhan0x01.github.io/ctf/2020/08/08/defcon-redteamvillage-ctf-tunneler-1,2,3,4,5,7,9.html
</span></span></code></pre></div><h2 id=resources>Resources<a href=#resources class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Some resources I think are helpful in understanding ssh tunneling properly.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>1. https://www.redhat.com/sysadmin/ssh-proxy-bastion-proxyjump
</span></span><span style=display:flex><span>2. https://www.cyberciti.biz/faq/linux-unix-ssh-proxycommand-passing-through-one-host-gateway-server/
</span></span><span style=display:flex><span>3. https://book.hacktricks.xyz/tunneling-and-port-forwarding
</span></span><span style=display:flex><span>4. https://linuxize.com/post/how-to-setup-ssh-tunneling/
</span></span><span style=display:flex><span>5. https://www.tecmint.com/create-ssh-tunneling-port-forwarding-in-linux/
</span></span><span style=display:flex><span>6. https://app.cyberranges.com/scenario/5d5c06ed960f032f2eadd733
</span></span><span style=display:flex><span>7. https://app.cyberranges.com/scenario/5d5eaf28960f032f2eae6add
</span></span><span style=display:flex><span>8. https://app.cyberranges.com/scenario/5d640b0c960f032f2eb033a8
</span></span></code></pre></div><p>You can reach/follow me on Twitter if you have some feedback or questions.</p><p>Twitter: <a href=https://twitter.com/ikuamike target=_blank rel=noopener>ikuamike</a></p><p>Github: <a href=https://github.com/ikuamike target=_blank rel=noopener>ikuamike</a></p></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=https://blog.ikuamike.io/posts/2020/metasploitctf2020/><span class=button__icon>←</span>
<span class=button__text>Metasploit Community CTF December 2020 WriteUp</span></a></span>
<span class="button next"><a href=https://blog.ikuamike.io/posts/2020/razictf-chasingalock-writeup/><span class=button__text>RaziCTF 2020 WriteUp: Chasing a lock</span>
<span class=button__icon>→</span></a></span></div></div></article></div><footer class=footer><div class=footer__inner><div class="copyright copyright--user"><span>© Michael Ikua</span>
<span>:: <a href=https://github.com/panr/hugo-theme-terminal target=_blank>Theme</a> made by <a href=https://github.com/panr target=_blank>panr</a></span></div></div></footer><script type=text/javascript src=/bundle.min.js></script></div><script src=/js/vanilla-back-to-top.min.js></script>
<script>addBackToTop({diameter:40,backgroundColor:"rgb(120, 226, 160)",textColor:"#1F222A",cornerOffset:30})</script><script src=/js/particles.min.js></script>
<script>particlesJS("particles-js",{particles:{number:{value:80,density:{enable:!0,value_area:1e3}},color:{value:"#ffffff"},shape:{type:"circle",stroke:{width:0,color:"#000000"}},opacity:{value:.5,random:!1,anim:{enable:!1,speed:1,opacity_min:.1,sync:!1}},size:{value:2,random:!0,anim:{enable:!1,speed:4,size_min:.1,sync:!1}},line_linked:{enable:!0,distance:150,color:"#ffffff",opacity:.3,width:1},move:{enable:!0,speed:.5,direction:"none",random:!0,straight:!1,out_mode:"out",bounce:!1,attract:{enable:!1,rotateX:600,rotateY:1200}}},retina_detect:!0})</script></body></html>