<!doctype html><html lang=en><head><title>NahamCon CTF 2024 WriteUp - Mobile</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Introduction Following my previous writeup that I did for Misc challenges in the NahamCon CTF, I decided to play the challenges in the Mobile category. This is post CTF as they left the challenges up for a few days after the competition was over.
I tried my best to not look at released writeups as I worked on these challenges as a way to learn something new or even just practice some of what I already know."><meta name=keywords content=","><meta name=robots content="noodp"><link rel=canonical href=https://blog.ikuamike.io/posts/2024/nahamcon_ctf_2024_mobile/><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-202973704-2","auto"),ga("send","pageview"))</script><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.ikuamike.io/img/nahamcon_ctf_2024/logo.jpeg"><meta name=twitter:title content="NahamCon CTF 2024 WriteUp - Mobile"><meta name=twitter:description content="Introduction Following my previous writeup that I did for Misc challenges in the NahamCon CTF, I decided to play the challenges in the Mobile category. This is post CTF as they left the challenges up for a few days after the competition was over.
I tried my best to not look at released writeups as I worked on these challenges as a way to learn something new or even just practice some of what I already know."><meta name=twitter:site content="@ikuamike"><link rel=stylesheet href=https://blog.ikuamike.io/styles.css><link rel=stylesheet href=https://blog.ikuamike.io/css/style.css><link rel="shortcut icon" href=https://blog.ikuamike.io/img/theme-colors/green.png><link rel=apple-touch-icon href=https://blog.ikuamike.io/img/theme-colors/green.png><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="NahamCon CTF 2024 WriteUp - Mobile"><meta property="og:description" content="Introduction Following my previous writeup that I did for Misc challenges in the NahamCon CTF, I decided to play the challenges in the Mobile category. This is post CTF as they left the challenges up for a few days after the competition was over.
I tried my best to not look at released writeups as I worked on these challenges as a way to learn something new or even just practice some of what I already know."><meta property="og:url" content="https://blog.ikuamike.io/posts/2024/nahamcon_ctf_2024_mobile/"><meta property="og:site_name" content><meta property="og:image" content="https://blog.ikuamike.io/img/nahamcon_ctf_2024/logo.jpeg"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><meta property="article:published_time" content="2024-05-28 00:02:45 +0300 +0300"></head><div id=particles-js></div><body class=green><div class="container center headings--one-size" style=background:#1f222a;z-index:1><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>> cd ~</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/about>About Me</a></li><li><a href=/all-posts>All Posts</a></li><li><a href=/tags>Tags</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/about>About Me</a></li><li><a href=/all-posts>All Posts</a></li><li><a href=/tags>Tags</a></li></ul></nav></header><div class=content><article class=post><h1 class=post-title><a href=https://blog.ikuamike.io/posts/2024/nahamcon_ctf_2024_mobile/>NahamCon CTF 2024 WriteUp - Mobile</a></h1><div class=post-meta><time class=post-date>2024-05-28</time></div><span class=post-tags>#<a href=https://blog.ikuamike.io/tags/ctf/>CTF</a>&nbsp;
#<a href=https://blog.ikuamike.io/tags/android/>Android</a>&nbsp;
#<a href=https://blog.ikuamike.io/tags/jadx-gui/>jadx-gui</a>&nbsp;
#<a href=https://blog.ikuamike.io/tags/logcat/>Logcat</a>&nbsp;</span><div class=table-of-contents><h2>Table of Contents</h2><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#1-kitty-kitty-bang-bang>1. Kitty Kitty Bang Bang</a></li><li><a href=#2-guitar>2. Guitar</a></li><li><a href=#3-buggy-jumper-1>3. Buggy Jumper 1</a></li><li><a href=#4-buggy-jumper-2>4. Buggy Jumper 2</a></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div><img src=https://blog.ikuamike.io/img/nahamcon_ctf_2024/logo.jpeg class=post-cover alt="NahamCon CTF 2024 WriteUp - Mobile" title="Cover Image"><div class=post-content><div><h2 id=introduction>Introduction<a href=#introduction class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Following my previous writeup that I did for Misc challenges in the NahamCon CTF, I decided to play the challenges in the Mobile category. This is post CTF as they left the challenges up for a few days after the competition was over.</p><p>I tried my best to not look at released writeups as I worked on these challenges as a way to learn something new or even just practice some of what I already know.</p><h2 id=1-kitty-kitty-bang-bang>1. Kitty Kitty Bang Bang<a href=#1-kitty-kitty-bang-bang class=hanchor arialabel=Anchor>&#8983;</a></h2><p>This challenge is rated <strong>Easy</strong>.</p><img src=/img/nahamcon_ctf_2024/kittykittybangbang_2.png class=center style=border-radius:8px><p>We are provided with the <a href=/files/nahamcon_ctf_2024/com.nahamcon2024.kittykittybangbang.apk>apk</a>
file for the challenge. I&rsquo;ll start by loading it into <a href=https://github.com/skylot/jadx/releases target=_blank rel=noopener>jadx-gui</a>
decompiler. Looking at the Android Manifest we see app info such as the package name, activity etc.</p><img src=/img/nahamcon_ctf_2024/kittykittybangbang_1.png class=center style=border-radius:8px><p>Navigating to the MainActivity and looking at the decompiled code, we note that the application logs several information including the flag.</p><img src=/img/nahamcon_ctf_2024/kittykittybangbang_3.png class=center style=border-radius:8px><p>With this knowledge, we can install the app in an emulator, I&rsquo;ll use genymotion and look at the logs.
When installed, the app only displays a picture of a cat.</p><img src=/img/nahamcon_ctf_2024/kittykittybangbang_4.png class=center style=border-radius:8px><p>To view the logs from the app, we first get the pid of the running app.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>adb shell ps | grep kitty
</span></span></code></pre></div><p>Once we have the pid, we can supply it to logcat.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>adb logcat -v color --pid<span style=color:#f92672>=</span><span style=color:#ae81ff>2333</span>
</span></span></code></pre></div><img src=/img/nahamcon_ctf_2024/kittykittybangbang_5.png class=center style=border-radius:8px><p>With the logs streaming in, we tap on the picture of the cat.</p><img src=/img/nahamcon_ctf_2024/kittykittybangbang_7.png class=center style=border-radius:8px><p>We then get the flag in the logs.</p><img src=/img/nahamcon_ctf_2024/kittykittybangbang_6.png class=center style=border-radius:8px><h2 id=2-guitar>2. Guitar<a href=#2-guitar class=hanchor arialabel=Anchor>&#8983;</a></h2><p>This challenge is rated <strong>Easy</strong>.</p><img src=/img/nahamcon_ctf_2024/Guitar_1.png class=center style=border-radius:8px><p>We are provided with the <a href=/files/nahamcon_ctf_2024/com.nahamcon2024.guitar.apk>apk</a>
which I&rsquo;ll load into jadx.</p><p>Looking through the Android Manifest and decompiled code, I eventually found the flag in the strings.xml file in base64 encoded format.</p><img src=/img/nahamcon_ctf_2024/Guitar_2.png class=center style=border-radius:8px><p>flag:</p><img src=/img/nahamcon_ctf_2024/Guitar_3.png class=center style=border-radius:8px><h2 id=3-buggy-jumper-1>3. Buggy Jumper 1<a href=#3-buggy-jumper-1 class=hanchor arialabel=Anchor>&#8983;</a></h2><p>This challenge is rated <strong>Easy</strong>.</p><img src=/img/nahamcon_ctf_2024/buggy_jumper_1.png class=center style=border-radius:8px><p>We are provided with the <a href=/files/nahamcon_ctf_2024/com.nahamcon2024.buggyjumper.apk>apk</a>
file for the challenge.</p><p>Starting off, I loaded the app into <a href=https://github.com/skylot/jadx/releases target=_blank rel=noopener>jadx-gui</a>
and started with checking out the Android Manifest.</p><img src=/img/nahamcon_ctf_2024/buggy_jumper_2.png class=center style=border-radius:8px><p>In the manifest, we see the package name, activity, service etc. We also see a reference to godot engine.</p><p>Looking at the listed activity and other parts of the application on jadx-gui didn&rsquo;t reveal much about the functionality of the app.</p><p>I then decided to load the app on genymotion emulator to have a feel of how it looks when it runs. It seems like a simple game.</p><img src=/img/nahamcon_ctf_2024/buggy_jumper_3.png class=center style=border-radius:8px><p>When we play, we have to click on the screen severally to make the bug jump, once the bug falls we get our score and points.</p><img src=/img/nahamcon_ctf_2024/buggy_jumper_4.png class=center style=border-radius:8px><p>On the shop interface, we can purchase the &lsquo;drip&rsquo;. All we need is 7331,7331 points but all we managed was 2 from the short gameplay.</p><img src=/img/nahamcon_ctf_2024/buggy_jumper_5.png class=center style=border-radius:8px><p>Back on the emulator, I got an adb shell and checked what local files I could find that could have been created by the app.</p><img src=/img/nahamcon_ctf_2024/buggy_jumper_6.png class=center style=border-radius:8px><p>There&rsquo;s not much, but seeing libgodot here probably means that it&rsquo;s important to the running of the app. Back on jadx-gui, looking at the resources/assets we have the libgodot in lib folder and also in the assets/scripts folder we have flag.gdc. This is possibly the flag but it&rsquo;s not readable here.</p><img src=/img/nahamcon_ctf_2024/buggy_jumper_7.png class=center style=border-radius:8px><p>After some research, gdc file format is godot engine compiled script. Godot engine is a game engine. I found that we can decompile the compiled script using Godot reverse engineering tools - <a href=https://github.com/bruvzg/gdsdecomp target=_blank rel=noopener>gdsdecomp</a>
.</p><p>With the tool downloaded, we can provide the apk directly to perform the decompilation.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>./gdre_tools.x86_64 --recover<span style=color:#f92672>=</span>../com.nahamcon2024.buggyjumper.apk
</span></span></code></pre></div><img src=/img/nahamcon_ctf_2024/buggy_jumper_8.png class=center style=border-radius:8px><p>This will create a new folder with the all the gdc files in the app decompiled. In the scripts folder, we get the flag now in plain text.</p><img src=/img/nahamcon_ctf_2024/buggy_jumper_9.png class=center style=border-radius:8px><h2 id=4-buggy-jumper-2>4. Buggy Jumper 2<a href=#4-buggy-jumper-2 class=hanchor arialabel=Anchor>&#8983;</a></h2><p>This challenge is rated <strong>Medium</strong>.</p><img src=/img/nahamcon_ctf_2024/buggy_jumper_10.png class=center style=border-radius:8px><p>This is a follow up of the previous challenge and we should use the same app. From the description, the focus is in the shop.</p><p>In the shop.gd file, we see the code for the shop.</p><img src=/img/nahamcon_ctf_2024/buggy_jumper_11.png class=center style=border-radius:8px><p>To buy the drip, a web request is sent to a url with an auth token and the value of points the response from this /verify endpoint will give the flag. The url is provided in the global.gd file.</p><img src=/img/nahamcon_ctf_2024/buggy_jumper_12.png class=center style=border-radius:8px><p>There&rsquo;s more code in the global.gd file. After reading the code, I understand the sequence needed to get the flag.</p><p>Below is the summary:</p><ul><li>Register via a POST request to the /register endpoint to get an auth token. The string <strong>Godot</strong> is required to be in the user agent.</li><li>Save points via a POST request to the /save endpoint. We need to set the points to be >=73317331 and in json format.</li><li>Make a request to /verify providing points >=73317331 to get the flag.</li></ul><img src=/img/nahamcon_ctf_2024/buggy_jumper_13.png class=center style=border-radius:8px><p>An alternative option to get the flag, is by letting the app make the request for us. We can manipulate the score value as this is stored in a local file <strong>saved_value.dat</strong>. We have seen this referenced in the code and in the local files on the emulator.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>echo <span style=color:#ae81ff>73317331</span> &gt; ./data_mirror/data_ce/null/0/com.nahamcon2024.buggyjump/files/saved_value.dat
</span></span></code></pre></div><p>Once we restart the app, we can get the flag.</p><img src=/img/nahamcon_ctf_2024/buggy_jumper_14.png class=center style=border-radius:8px><h2 id=conclusion>Conclusion<a href=#conclusion class=hanchor arialabel=Anchor>&#8983;</a></h2><p>The mobile app challenges were quite nice to go over, thankful to the NahamCon CTF team that they left the challenges accessible post event.</p><p>There are 2 challenges that I didn&rsquo;t manage to solve. I realized the app was written in flutter and it seems there&rsquo;s a unique step by step for testing apps written in flutter. I&rsquo;ll be digging deeper to learn how to work with apps made in flutter.</p><p>Here is a link to another writeup that covers the remaining 2 challenges:</p><p><a href=https://hackmd.io/@avila-pwn-notes/r183kzlEA target=_blank rel=noopener>https://hackmd.io/@avila-pwn-notes/r183kzlEA</a></p></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=https://blog.ikuamike.io/posts/2024/p3rf3ctr00t_ctf_2024_ad/><span class=button__icon>←</span>
<span class=button__text>P3RF3CT R00T CTF 2024 Writeup - Active Directory</span></a></span>
<span class="button next"><a href=https://blog.ikuamike.io/posts/2024/nahamcon_ctf_2024_misc/><span class=button__text>NahamCon CTF 2024 WriteUp - Misc</span>
<span class=button__icon>→</span></a></span></div></div></article></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2024 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: <a href=https://github.com/panr/hugo-theme-terminal target=_blank>Theme</a> made by <a href=https://github.com/panr target=_blank>panr</a></span></div></div></footer><script type=text/javascript src=/bundle.min.js></script></div><script src=/js/vanilla-back-to-top.min.js></script>
<script>addBackToTop({diameter:40,backgroundColor:"rgb(120, 226, 160)",textColor:"#1F222A",cornerOffset:30})</script><script src=/js/particles.min.js></script>
<script>particlesJS("particles-js",{particles:{number:{value:80,density:{enable:!0,value_area:1e3}},color:{value:"#ffffff"},shape:{type:"circle",stroke:{width:0,color:"#000000"}},opacity:{value:.5,random:!1,anim:{enable:!1,speed:1,opacity_min:.1,sync:!1}},size:{value:2,random:!0,anim:{enable:!1,speed:4,size_min:.1,sync:!1}},line_linked:{enable:!0,distance:150,color:"#ffffff",opacity:.3,width:1},move:{enable:!0,speed:.5,direction:"none",random:!0,straight:!1,out_mode:"out",bounce:!1,attract:{enable:!1,rotateX:600,rotateY:1200}}},retina_detect:!0})</script></body></html>