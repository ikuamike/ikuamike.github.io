<!doctype html><html lang=en><head><title>HTB Business CTF 2024 WriteUp - Misc ::</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content=","><meta name=robots content="noodp"><link rel=canonical href=https://blog.ikuamike.io/posts/2024/htb_business_ctf_2024_misc/><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-202973704-2","auto"),ga("send","pageview"))</script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-202973704-2","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.ikuamike.io/img/htb_business_ctf_2024/ctf_logo.jpg"><meta name=twitter:title content="HTB Business CTF 2024 WriteUp - Misc"><meta name=twitter:description content><meta name=twitter:site content="@ikuamike"><link rel=stylesheet href=https://blog.ikuamike.io/styles.css><link rel=stylesheet href=https://blog.ikuamike.io/css/style.css><link rel="shortcut icon" href=https://blog.ikuamike.io/img/theme-colors/green.png><link rel=apple-touch-icon href=https://blog.ikuamike.io/img/theme-colors/green.png><meta name=twitter:card content="summary_large_image"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="HTB Business CTF 2024 WriteUp - Misc"><meta property="og:description" content><meta property="og:url" content="https://blog.ikuamike.io/posts/2024/htb_business_ctf_2024_misc/"><meta property="og:site_name" content><meta property="og:image" content="https://blog.ikuamike.io/"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><meta property="article:published_time" content="2024-05-22 00:25:15 +0300 +0300"></head><div id=particles-js></div><body class=green><div class="container center headings--one-size" style=background:#1f222a;z-index:1><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>> cd ~</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/about>About Me</a></li><li><a href=/all-posts>All Posts</a></li><li><a href=/tags>Tags</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/about>About Me</a></li><li><a href=/all-posts>All Posts</a></li><li><a href=/tags>Tags</a></li></ul></nav></header><div class=content><article class=post><h1 class=post-title><a href=https://blog.ikuamike.io/posts/2024/htb_business_ctf_2024_misc/>HTB Business CTF 2024 WriteUp - Misc</a></h1><div class=post-meta><time class=post-date>2024-05-22 ::</time></div><span class=post-tags>#<a href=https://blog.ikuamike.io/tags/ctf/>CTF</a>&nbsp;
#<a href=https://blog.ikuamike.io/tags/misc/>Misc</a>&nbsp;
#<a href=https://blog.ikuamike.io/tags/web/>Web</a>&nbsp;
#<a href=https://blog.ikuamike.io/tags/unicode/>Unicode</a>&nbsp;
#<a href=https://blog.ikuamike.io/tags/python/>Python</a>&nbsp;
#<a href=https://blog.ikuamike.io/tags/git/>Git</a>&nbsp;</span><div class=table-of-contents><h2>Table of Contents</h2><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a><ul><li><a href=#1-hidden-path>1. Hidden Path</a></li><li><a href=#2-locked-away>2. Locked Away</a></li><li><a href=#3-zephyr>3. Zephyr</a></li></ul></li></ul></nav></div><div class=post-content><div><img src=/img/htb_business_ctf_2024/ctf_logo.jpg class=center style=border-radius:8px><h2 id=introduction>Introduction<a href=#introduction class=hanchor arialabel=Anchor>&#8983;</a></h2><p>In this post, I&rsquo;ll be covering solutions to the Misc Challenges from the <a href=https://ctf.hackthebox.com/event/details/htb-business-ctf-2024-the-vault-of-hope-1474 target=_blank rel=noopener>HTB Business CTF 2024</a>
.</p><h3 id=1-hidden-path>1. Hidden Path<a href=#1-hidden-path class=hanchor arialabel=Anchor>&#8983;</a></h3><p>This challenge was rated <strong>Easy</strong>. We are provided with files to download, allowing us to read the app&rsquo;s source code.</p><img src=/img/htb_business_ctf_2024/misc/hidden_path_1.png class=center style=border-radius:8px><p>On reading the code, we see that the app accepts user input on the <em><strong>/server_status</strong></em> endpoint. It takes in <em><strong>choice</strong></em> parameter and something else.</p><p>Initially I didn&rsquo;t immediately pick this out but after looking closely, my code editor highlights that there is another parameter. Hovering my mouse over it revealed that it was the invisible unicode character U+3164. This character also appears to be also used in the array listing command choices that can be executed.</p><p>What this means is that, we can supply a command to this character then select it as our command choice using the index in the array .</p><p>I copied the unicode character from this <a href=https://unicode-explorer.com/c/3164 target=_blank rel=noopener>unicode-explorer</a>
link, then crafted my request as below in burp.ㅤ</p><img src=/img/htb_business_ctf_2024/misc/hidden_path_2.png class=center style=border-radius:8px><p>Flag: <strong>HTB{1nvi5IBl3_cH4r4cT3rS_n0t_sO_v1SIbL3_2b06cb9b519dd72e472ccdadda3917ce}</strong></p><h3 id=2-locked-away>2. Locked Away<a href=#2-locked-away class=hanchor arialabel=Anchor>&#8983;</a></h3><p>This challenge was also rated <strong>Easy</strong>. Here we are also provided the code. For the challenge.</p><img src=/img/htb_business_ctf_2024/misc/locked_away_1.png class=center style=border-radius:8px><p>As seen, our input will be checked against a blacklist then passed to exec command.</p><p>Since exec will execute any python code we supply, we can override the blacklist list by assigning it something different rendering it useless then read the flag by calling the openchest function.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span>blacklist <span style=color:#f92672>=</span> str(<span style=color:#ae81ff>1</span>),str(<span style=color:#ae81ff>2</span>),str(<span style=color:#ae81ff>3</span>)
</span></span></code></pre></div><p>We can also drop into a shell by import pty module.</p><img src=/img/htb_business_ctf_2024/misc/locked_away_2.png class=center style=border-radius:8px><p>Flag: <strong>HTB{bYp4sSeD_tH3_fIlT3r5?_aLw4Ys_b3_c4RefUL!_ab204eba259a305414b338855f2fd91d}</strong></p><h3 id=3-zephyr>3. Zephyr<a href=#3-zephyr class=hanchor arialabel=Anchor>&#8983;</a></h3><p>This challenge was rated <strong>Medium</strong>. We are also provided with the challenge files.</p><img src=/img/htb_business_ctf_2024/misc/zephyr_1.png class=center style=border-radius:8px><p>On the terminal, when we navigate to the folder, we note that this is a git repo with only two files. My terminal prompt also picks up the main branch.</p><p>Let&rsquo;s check the commit history on the main branch.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>git --no-pager log
</span></span></code></pre></div><img src=/img/htb_business_ctf_2024/misc/zephyr_2.png class=center style=border-radius:8px><p>We only have 2 commits, lets view the modification using git diff.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>git --no-pager diff <span style=color:#ae81ff>1501</span>  ae4f
</span></span></code></pre></div><img src=/img/htb_business_ctf_2024/misc/zephyr_4.png class=center style=border-radius:8px><p>We see that only the <em><strong>database.db</strong></em> file has been modified. Let&rsquo;s checkout the initial commit to view what sensitive info was removed.</p><img src=/img/htb_business_ctf_2024/misc/zephyr_3.png class=center style=border-radius:8px><p>From this initial commit, we get a piece of the flag: <strong>_gOT_thE_DB_</strong>.</p><p>Now let&rsquo;s check if there are any other branches and switch to them.</p><img src=/img/htb_business_ctf_2024/misc/zephyr_5.png class=center style=border-radius:8px><p>On the <em><strong>w4rri0r-changes</strong></em> branch, we see there is a new commit. We can use <em>git log</em> again but with <em>-p</em> option to view the changes.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>git --no-pager log -p
</span></span></code></pre></div><img src=/img/htb_business_ctf_2024/misc/zephyr_6.png class=center style=border-radius:8px><p>We now have another piece of the flag: <strong>HTB{g0t_tH3_p4s5</strong>.</p><p>Finally, after some time going through the files trying to get the final piece. I discovered file changes in a git repo can also be stored in stash.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>git --no-pager stash show -p
</span></span></code></pre></div><img src=/img/htb_business_ctf_2024/misc/zephyr_7.png class=center style=border-radius:8px><p>After checking the stash, we now have the final piece of the flag: <strong>g0T_TH3_sT4sH}</strong>.</p><p>Flag: <strong>HTB{g0t_tH3_p4s5_gOT_thE_DB_g0T_TH3_sT4sH}</strong></p></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=https://blog.ikuamike.io/posts/2024/htb_business_ctf_2024_fullpwn/><span class=button__icon>←</span>
<span class=button__text>HTB Business CTF 2024 WriteUp - FullPwn</span></a></span>
<span class="button next"><a href=https://blog.ikuamike.io/posts/2022/forest-htb/><span class=button__text>Hack The Box: Forest</span>
<span class=button__icon>→</span></a></span></div></div></article></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2024 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: <a href=https://github.com/panr/hugo-theme-terminal target=_blank>Theme</a> made by <a href=https://github.com/panr target=_blank>panr</a></span></div></div></footer><script type=text/javascript src=/bundle.min.js></script></div><script src=/js/vanilla-back-to-top.min.js></script>
<script>addBackToTop({diameter:40,backgroundColor:"rgb(120, 226, 160)",textColor:"#1F222A",cornerOffset:30})</script><script src=/js/particles.min.js></script>
<script>particlesJS("particles-js",{particles:{number:{value:80,density:{enable:!0,value_area:1e3}},color:{value:"#ffffff"},shape:{type:"circle",stroke:{width:0,color:"#000000"}},opacity:{value:.5,random:!1,anim:{enable:!1,speed:1,opacity_min:.1,sync:!1}},size:{value:2,random:!0,anim:{enable:!1,speed:4,size_min:.1,sync:!1}},line_linked:{enable:!0,distance:150,color:"#ffffff",opacity:.3,width:1},move:{enable:!0,speed:.5,direction:"none",random:!0,straight:!1,out_mode:"out",bounce:!1,attract:{enable:!1,rotateX:600,rotateY:1200}}},retina_detect:!0})</script></body></html>