<!doctype html><html lang=en><head><title>NahamCon CTF 2024 WriteUp - Miscellaneous ::</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content=","><meta name=robots content="noodp"><link rel=canonical href=https://blog.ikuamike.io/posts/2024/nahamcon_ctf_2024_misc/><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-202973704-2","auto"),ga("send","pageview"))</script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-202973704-2","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.ikuamike.io/img/htb_business_ctf_2024/ctf_logo.jpg"><meta name=twitter:title content="NahamCon CTF 2024 WriteUp - Miscellaneous"><meta name=twitter:description content><meta name=twitter:site content="@ikuamike"><link rel=stylesheet href=https://blog.ikuamike.io/styles.css><link rel=stylesheet href=https://blog.ikuamike.io/css/style.css><link rel="shortcut icon" href=https://blog.ikuamike.io/img/theme-colors/green.png><link rel=apple-touch-icon href=https://blog.ikuamike.io/img/theme-colors/green.png><meta name=twitter:card content="summary_large_image"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="NahamCon CTF 2024 WriteUp - Miscellaneous"><meta property="og:description" content><meta property="og:url" content="https://blog.ikuamike.io/posts/2024/nahamcon_ctf_2024_misc/"><meta property="og:site_name" content><meta property="og:image" content="https://blog.ikuamike.io/"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><meta property="article:published_time" content="2024-05-25 21:17:45 +0300 +0300"></head><div id=particles-js></div><body class=green><div class="container center headings--one-size" style=background:#1f222a;z-index:1><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>> cd ~</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/about>About Me</a></li><li><a href=/all-posts>All Posts</a></li><li><a href=/tags>Tags</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/about>About Me</a></li><li><a href=/all-posts>All Posts</a></li><li><a href=/tags>Tags</a></li></ul></nav></header><div class=content><article class=post><h1 class=post-title><a href=https://blog.ikuamike.io/posts/2024/nahamcon_ctf_2024_misc/>NahamCon CTF 2024 WriteUp - Miscellaneous</a></h1><div class=post-meta><time class=post-date>2024-05-25 ::</time></div><span class=post-tags>#<a href=https://blog.ikuamike.io/tags/ctf/>CTF</a>&nbsp;
#<a href=https://blog.ikuamike.io/tags/lynx/>Lynx</a>&nbsp;
#<a href=https://blog.ikuamike.io/tags/curl/>Curl</a>&nbsp;
#<a href=https://blog.ikuamike.io/tags/passwd/>Passwd</a>&nbsp;</span><div class=table-of-contents><h2>Table of Contents</h2><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#1-securesurfer>1. SecureSurfer</a></li><li><a href=#2-curly-fries>2. Curly Fries</a></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div><div class=post-content><div><img src=/img/nahamcon_ctf_2024/logo.jpeg class=center style=border-radius:8px><h2 id=introduction>Introduction<a href=#introduction class=hanchor arialabel=Anchor>&#8983;</a></h2><p>NahamCon 2024 is taking place this weekend and they had a CTF as part of the online conference. I participated with team <a href=https://twitter.com/fr334aks target=_blank rel=noopener>fr334aks</a>
.</p><p>We managed position 197. We did good on Web, Mobile and WarmUps but not well on other categories like Binary Exploitation and Crypto.</p><img src=/img/nahamcon_ctf_2024/cert.png class=center style=border-radius:8px><p>It was our first CTF of the year together, so it&rsquo;s not a bad start from a long break. Hopefully we get back to our winning ways :).</p><p>I only solved 2 Miscellaneous challenges that I am writing about in this post.</p><h2 id=1-securesurfer>1. SecureSurfer<a href=#1-securesurfer class=hanchor arialabel=Anchor>&#8983;</a></h2><img src=/img/nahamcon_ctf_2024/secure_surfer_1.png class=center style=border-radius:8px><p>We begin with ssh access to the challenge environment, we are also provided with <a href=/files/nahamcon_ctf_2024/securesurfer.c>securesurfer.c</a>
file. Our objective is to gain root access to get the flag.</p><img src=/img/nahamcon_ctf_2024/secure_surfer_2.png class=center style=border-radius:8px><p>When we ssh, it seems the securesurfer program is executed and we are provided with a few options.</p><p>If we look at the code provided, the only option that takes user input is option 6 which is a url that will be loaded using lynx browser on the terminal.</p><p>We can see that the user input is not sanitized/validated, the only check done is that the url has to begin with <code>https://</code>.</p><img src=/img/nahamcon_ctf_2024/secure_surfer_4.png class=center style=border-radius:8px><p>We can therefore inject our own commands to break out of the program and into a shell. After the url we can inject the below payload.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#e6db74>&#39;;bash;&#39;</span>
</span></span></code></pre></div><p>Once lynx program is done loading the url, we get a bash shell.</p><img src=/img/nahamcon_ctf_2024/secure_surfer_3.png class=center style=border-radius:8px><p>To escalate our privileges, we find that the securesurfer user can run lynx as root.</p><img src=/img/nahamcon_ctf_2024/secure_surfer_5.png class=center style=border-radius:8px><p>We can then try accessing the root folder using the below command.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>sudo /usr/local/bin/lynx file:///root
</span></span></code></pre></div><img src=/img/nahamcon_ctf_2024/secure_surfer_6.png class=center style=border-radius:8px><p>Here we see the get flag binary, we can then download it to our local directory and execute it to get the flag.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>sudo /usr/local/bin/lynx -source file:///root/get_flag_random_suffix_21505252448959 &gt; get_flag
</span></span></code></pre></div><img src=/img/nahamcon_ctf_2024/secure_surfer_7.png class=center style=border-radius:8px><p>If we wanted to get a root shell, one way is to overwrite the passwd file to add a user with root privileges.</p><p>We&rsquo;ll begin by creating a password hash for the user we want to add to the passwd file, the password here is <strong>hacker</strong>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>openssl passwd -1 -salt hacker hacker
</span></span></code></pre></div><p>Then we&rsquo;ll copy the current passwd file to our directory and add our new user to the file, using the below format where we specify the user with id 0 to give root privileges. The username is <strong>hacker</strong>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>echo <span style=color:#e6db74>&#39;hacker:$1$hacker$TzyKlv0/R/c28R.GAeLw.1:0:0:Hacker:/root:/bin/bash&#39;</span> &gt;&gt; passwd
</span></span></code></pre></div><img src=/img/nahamcon_ctf_2024/secure_surfer_8.png class=center style=border-radius:8px><p>Then we&rsquo;ll launch lynx and overwrite the /etc/passwd with our modified passwd file.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>sudo /usr/local/bin/lynx file:///home/securesurfer/passwd
</span></span></code></pre></div><p>Once we are in lynx, we will press <strong>P</strong> which is the print option, and we select <strong>Save to a local file</strong> and press enter.</p><img src=/img/nahamcon_ctf_2024/secure_surfer_9.png class=center style=border-radius:8px><p>We can then update the filename to /etc/passwd.</p><img src=/img/nahamcon_ctf_2024/secure_surfer_10.png class=center style=border-radius:8px><p>Once we say yes to Overwrite the file, we can quit lynx and switch to the <code>hacker</code> user, using the password <code>hacker</code> to get a root shell.</p><img src=/img/nahamcon_ctf_2024/secure_surfer_11.png class=center style=border-radius:8px><h2 id=2-curly-fries>2. Curly Fries<a href=#2-curly-fries class=hanchor arialabel=Anchor>&#8983;</a></h2><img src=/img/nahamcon_ctf_2024/curly_fries_1.png class=center style=border-radius:8px><p>For this challenge, we begin by ssh into the challenge environment. Our objective is to escalate to root and get the flag.</p><p>Our user has sudo privileges to run curl impersonating the user fry, however this configuration is not vulnerable to abuse.</p><img src=/img/nahamcon_ctf_2024/curly_fries_2.png class=center style=border-radius:8px><p>Looking around, we find that in fry&rsquo;s home folder we can read the bash_history file. This gives us their password.</p><img src=/img/nahamcon_ctf_2024/curly_fries_3.png class=center style=border-radius:8px><p>Switching to the user fry, we see they can run curl as root but the configuration includes a wildcard. This is different from the previous configuration and we can abuse it.</p><img src=/img/nahamcon_ctf_2024/curly_fries_4.png class=center style=border-radius:8px><p>Similar to the previous challenge, we&rsquo;ll use curl to overwrite the passwd file with a modified version that has the hacker user with root privileges.</p><p>I set up a python web server to serve the modified passwd file and then downloaded it and perform the overwrite.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>sudo /usr/bin/curl 127.0.0.1:8000/health-check -o /etc/passwd
</span></span></code></pre></div><img src=/img/nahamcon_ctf_2024/curly_fries_5.png class=center style=border-radius:8px><h2 id=conclusion>Conclusion<a href=#conclusion class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Thanks to John Hammond, NahamSec and the rest of challenge creators for putting together yet another great CTF this year. I didn&rsquo;t put in a lot of time to solve more challenges but I still had a good time.</p><p>You can catch the conference live here: <a href="https://www.youtube.com/live/76mNNVVBht0?si=E2TKu8fJD6SNXFCR" target=_blank rel=noopener>NahamCon CTF 2024 Live Stream</a></p></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button next"><a href=https://blog.ikuamike.io/posts/2024/htb_business_ctf_2024_fullpwn/><span class=button__text>HTB Business CTF 2024 WriteUp - FullPwn</span>
<span class=button__icon>→</span></a></span></div></div></article></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2024 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: <a href=https://github.com/panr/hugo-theme-terminal target=_blank>Theme</a> made by <a href=https://github.com/panr target=_blank>panr</a></span></div></div></footer><script type=text/javascript src=/bundle.min.js></script></div><script src=/js/vanilla-back-to-top.min.js></script>
<script>addBackToTop({diameter:40,backgroundColor:"rgb(120, 226, 160)",textColor:"#1F222A",cornerOffset:30})</script><script src=/js/particles.min.js></script>
<script>particlesJS("particles-js",{particles:{number:{value:80,density:{enable:!0,value_area:1e3}},color:{value:"#ffffff"},shape:{type:"circle",stroke:{width:0,color:"#000000"}},opacity:{value:.5,random:!1,anim:{enable:!1,speed:1,opacity_min:.1,sync:!1}},size:{value:2,random:!0,anim:{enable:!1,speed:4,size_min:.1,sync:!1}},line_linked:{enable:!0,distance:150,color:"#ffffff",opacity:.3,width:1},move:{enable:!0,speed:.5,direction:"none",random:!0,straight:!1,out_mode:"out",bounce:!1,attract:{enable:!1,rotateX:600,rotateY:1200}}},retina_detect:!0})</script></body></html>