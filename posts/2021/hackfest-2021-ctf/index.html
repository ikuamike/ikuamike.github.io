<!doctype html><html lang=en><head><title>SheHacksKE HackFest 2021 CTF WriteUp</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Introduction @SheHacksKE held their yearly hackfest event in October 2021 but it was online this year. The event included a CTF that was facilitated by @eKRAALhub . @mystic_kev and I participated in the CTF as NoPwnNoGain and won it by completed all challenges. This writeup is for the challenges I was able to solve.
Challenges: Firmware 1. Camera Kernel The provided file when extracted contains a bin file that is a linux image."><meta name=keywords content=","><meta name=robots content="noodp"><link rel=canonical href=https://blog.ikuamike.io/posts/2021/hackfest-2021-ctf/><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-202973704-2","auto"),ga("send","pageview"))</script><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.ikuamike.io/img/shehacks-hackfest-2021/banner.png"><meta name=twitter:title content="SheHacksKE HackFest 2021 CTF WriteUp"><meta name=twitter:description content="Introduction @SheHacksKE held their yearly hackfest event in October 2021 but it was online this year. The event included a CTF that was facilitated by @eKRAALhub . @mystic_kev and I participated in the CTF as NoPwnNoGain and won it by completed all challenges. This writeup is for the challenges I was able to solve.
Challenges: Firmware 1. Camera Kernel The provided file when extracted contains a bin file that is a linux image."><meta name=twitter:site content="@ikuamike"><link rel=stylesheet href=https://blog.ikuamike.io/styles.css><link rel=stylesheet href=https://blog.ikuamike.io/css/style.css><link rel="shortcut icon" href=https://blog.ikuamike.io/img/theme-colors/green.png><link rel=apple-touch-icon href=https://blog.ikuamike.io/img/theme-colors/green.png><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="SheHacksKE HackFest 2021 CTF WriteUp"><meta property="og:description" content="Introduction @SheHacksKE held their yearly hackfest event in October 2021 but it was online this year. The event included a CTF that was facilitated by @eKRAALhub . @mystic_kev and I participated in the CTF as NoPwnNoGain and won it by completed all challenges. This writeup is for the challenges I was able to solve.
Challenges: Firmware 1. Camera Kernel The provided file when extracted contains a bin file that is a linux image."><meta property="og:url" content="https://blog.ikuamike.io/posts/2021/hackfest-2021-ctf/"><meta property="og:site_name" content><meta property="og:image" content="https://blog.ikuamike.io/img/shehacks-hackfest-2021/banner.png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><meta property="article:published_time" content="2021-11-11 00:00:00 +0000 UTC"></head><div id=particles-js></div><body class=green><div class="container center headings--one-size" style=background:#1f222a;z-index:1><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>> cd ~</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/about>About Me</a></li><li><a href=/all-posts>All Posts</a></li><li><a href=/tags>Tags</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/about>About Me</a></li><li><a href=/all-posts>All Posts</a></li><li><a href=/tags>Tags</a></li></ul></nav></header><div class=content><article class=post><h1 class=post-title><a href=https://blog.ikuamike.io/posts/2021/hackfest-2021-ctf/>SheHacksKE HackFest 2021 CTF WriteUp</a></h1><div class=post-meta><time class=post-date>2021-11-11</time></div><span class=post-tags>#<a href=https://blog.ikuamike.io/tags/ctf/>CTF</a>&nbsp;
#<a href=https://blog.ikuamike.io/tags/forensics/>Forensics</a>&nbsp;</span><div class=table-of-contents><h2>Table of Contents</h2><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#challenges-firmware>Challenges: Firmware</a><ul><li><a href=#1-camera-kernel>1. Camera Kernel</a></li><li><a href=#2-backups>2. Backups</a></li><li><a href=#3-semiconductor>3. Semiconductor</a></li><li><a href=#4-leaky-developer>4. Leaky Developer</a></li><li><a href=#5-root>5. Root</a></li><li><a href=#6-extras>6. Extras</a></li><li><a href=#7-the-rest>7. The Rest</a></li></ul></li><li><a href=#challenges-protocols>Challenges: Protocols</a><ul><li><a href=#1-subscriber>1. Subscriber</a></li><li><a href=#2-hardcoded>2. Hardcoded</a></li></ul></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div><img src=https://blog.ikuamike.io/img/shehacks-hackfest-2021/banner.png class=post-cover alt="SheHacksKE HackFest 2021 CTF WriteUp" title="Cover Image"><div class=post-content><div><h2 id=introduction>Introduction<a href=#introduction class=hanchor arialabel=Anchor>&#8983;</a></h2><p><a href=https://twitter.com/shehacks_ke target=_blank rel=noopener>@SheHacksKE</a>
held their yearly hackfest event in October 2021 but it was online this year. The event included a CTF
that was facilitated by <a href=https://twitter.com/eKRAALhub target=_blank rel=noopener>@eKRAALhub</a>
. <a href=https://twitter.com/mystic_kev target=_blank rel=noopener>@mystic_kev</a>
and I participated in the CTF as
NoPwnNoGain and won it by completed all challenges. This writeup is for the challenges I was able to solve.</p><h2 id=challenges-firmware>Challenges: Firmware<a href=#challenges-firmware class=hanchor arialabel=Anchor>&#8983;</a></h2><h3 id=1-camera-kernel>1. Camera Kernel<a href=#1-camera-kernel class=hanchor arialabel=Anchor>&#8983;</a></h3><img src=/img/shehacks-hackfest-2021/kernel1.png class=center style=border-radius:8px><p>The provided file when extracted contains a bin file that is a linux image.</p><img src=/img/shehacks-hackfest-2021/kernel2.png class=center style=border-radius:8px><p>By using binwalk to analyse the file we see the different file sections.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>binwalk demo.bin
</span></span></code></pre></div><p>The kernel starts at the second section indicated as the <strong>OS Kernel Image</strong> and includes the <strong>lzma compressed
data</strong> to end at the beginning of the squashfs filesystem.</p><img src=/img/shehacks-hackfest-2021/kernel3.png class=center style=border-radius:8px><p>To provide the flag in decimal we minus the header that identifies the firmware image.</p><pre tabindex=0><code>2097216 - 64 = 2097152
</code></pre><p>Flag: <code>Hackfest{2097152}</code></p><h3 id=2-backups>2. Backups<a href=#2-backups class=hanchor arialabel=Anchor>&#8983;</a></h3><img src=/img/shehacks-hackfest-2021/kernel4.png class=center style=border-radius:8px><p>Based on the binwalk output we can take the root filesystem as the first squashfs filesystem. We can calculate the size as below.</p><pre tabindex=0><code>5570624 - 2097216 = 3473408
</code></pre><p>To extract it we can use <strong>dd</strong> command line tool then mount the filesystem.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>dd <span style=color:#66d9ef>if</span><span style=color:#f92672>=</span>demo.bin skip<span style=color:#f92672>=</span><span style=color:#ae81ff>2097216</span> count<span style=color:#f92672>=</span><span style=color:#ae81ff>3473408</span> bs<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> of<span style=color:#f92672>=</span>squashfs1 
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>sudo mount -t squashfs squashfs1 mount1
</span></span></code></pre></div><img src=/img/shehacks-hackfest-2021/kernel5.png class=center style=border-radius:8px><p>On mounting the filesystem we see the backup folders.</p><p>Flag: <code>Hackfest{backupa,backupd,backupk}</code></p><h3 id=3-semiconductor>3. Semiconductor<a href=#3-semiconductor class=hanchor arialabel=Anchor>&#8983;</a></h3><img src=/img/shehacks-hackfest-2021/kernel6.png class=center style=border-radius:8px><p>By looking around the root filesystem we can read the hostname of the device this image was retrieved from.</p><img src=/img/shehacks-hackfest-2021/kernel7.png class=center style=border-radius:8px><p>Searching this name on google shows this is a semiconductor company confirming this is the flag.</p><img src=/img/shehacks-hackfest-2021/kernel8.png class=center style=border-radius:8px><p>Flag: <code>Hackfest{Ingenic}</code></p><h3 id=4-leaky-developer>4. Leaky Developer<a href=#4-leaky-developer class=hanchor arialabel=Anchor>&#8983;</a></h3><img src=/img/shehacks-hackfest-2021/kernel12.png class=center style=border-radius:8px><p>The rest of the filesystem is inside the jffs2 filesystem that starts offset <strong>6225984</strong> until the end.</p><img src=/img/shehacks-hackfest-2021/kernel13.png class=center style=border-radius:8px><p>To extract it we can carve it out using dd.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>dd <span style=color:#66d9ef>if</span><span style=color:#f92672>=</span>demo.bin skip<span style=color:#f92672>=</span><span style=color:#ae81ff>6225984</span> bs<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> of<span style=color:#f92672>=</span>jffs
</span></span></code></pre></div><p>To mount the jffs2 file system, I found the below script to be useful.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#75715e>#!/bin/sh
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>set -e
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> -z <span style=color:#e6db74>&#34;</span>$1<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    echo usage: $0 jffs2_image directory
</span></span><span style=display:flex><span>    exit
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> -z <span style=color:#e6db74>&#34;</span>$2<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    echo usage: $0 jffs2_image directory
</span></span><span style=display:flex><span>    exit
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># modprobe mtdcore</span>
</span></span><span style=display:flex><span>modprobe jffs2
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>SIZE<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>du -h -k $1 | cut -f 1<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>SIZE<span style=color:#f92672>=</span><span style=color:#ae81ff>8192</span> <span style=color:#75715e># 65536</span>
</span></span><span style=display:flex><span>ESIZE<span style=color:#f92672>=</span><span style=color:#66d9ef>$((</span> $SIZE <span style=color:#f92672>/</span> <span style=color:#ae81ff>6</span><span style=color:#66d9ef>))</span>
</span></span><span style=display:flex><span>BUFS<span style=color:#f92672>=</span><span style=color:#ae81ff>512</span>
</span></span><span style=display:flex><span>modprobe mtdram <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span> total_size<span style=color:#f92672>=</span>$SIZE <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span> erase_size<span style=color:#f92672>=</span><span style=color:#e6db74>${</span>ESIZE<span style=color:#e6db74>}</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span><span style=color:#75715e># writebuf_size=$BUFS</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># modprobe mtdchar</span>
</span></span><span style=display:flex><span>modprobe mtdblock
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>sleep .25
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>dd <span style=color:#66d9ef>if</span><span style=color:#f92672>=</span>$1 of<span style=color:#f92672>=</span>/dev/mtd0
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mount -t jffs2 /dev/mtdblock0 $2
</span></span></code></pre></div><p>Once we mount the filesystem as below, there&rsquo;s a mount.sh file inside the bin directory that shows the folder in the
home directory.</p><img src=/img/shehacks-hackfest-2021/kernel14.png class=center style=border-radius:8px><p>Flag: <code>Hackfest{xuxuequan}</code></p><h3 id=5-root>5. Root<a href=#5-root class=hanchor arialabel=Anchor>&#8983;</a></h3><img src=/img/shehacks-hackfest-2021/kernel10.png class=center style=border-radius:8px><p>The shadow file in the root filesystem contains the root hash.</p><img src=/img/shehacks-hackfest-2021/kernel9.png class=center style=border-radius:8px><p>I tried to crack this hash using the usual rockyou wordlist but got nothing so I jumped to google to see if I get any
hits.</p><img src=/img/shehacks-hackfest-2021/kernel11.png class=center style=border-radius:8px><p>Flag: <code>Hackfest{ismart12}</code></p><h3 id=6-extras>6. Extras<a href=#6-extras class=hanchor arialabel=Anchor>&#8983;</a></h3><p>The above solutions were after some analysis of how I believe the challenges we meant to be solved. Initially I did the
basic option of extracting the image using binwalk.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>binwalk -e demo.bin
</span></span></code></pre></div><p>After this and looking through the resulting directories and some google searches later I found this post that allowed me to quickly answer
the questions.</p><pre tabindex=0><code>https://research.nccgroup.com/2020/07/31/lights-camera-hacked-an-insight-into-the-world-of-popular-ip-cameras/
</code></pre><h3 id=7-the-rest>7. The Rest<a href=#7-the-rest class=hanchor arialabel=Anchor>&#8983;</a></h3><p>The rest of the challenges in this category were solved by Kelvin.</p><pre tabindex=0><code>https://github.com/mystickev/CTFwriteups/tree/Writeups/shehacks-2021
</code></pre><h2 id=challenges-protocols>Challenges: Protocols<a href=#challenges-protocols class=hanchor arialabel=Anchor>&#8983;</a></h2><h3 id=1-subscriber>1. Subscriber<a href=#1-subscriber class=hanchor arialabel=Anchor>&#8983;</a></h3><img src=/img/shehacks-hackfest-2021/kernel15.png class=center style=border-radius:8px><p>First thing I did was run nmap against the host and port to figure out what the service is running.</p><img src=/img/shehacks-hackfest-2021/kernel16.png class=center style=border-radius:8px><p>On discovering this is mqtt, I downloaded <a href=https://github.com/thomasnordquist/MQTT-Explorer/releases target=_blank rel=noopener>mqtt explorer</a>
.</p><img src=/img/shehacks-hackfest-2021/kernel17.png class=center style=border-radius:8px><p>Once we connect we start receiving messages, after a while the flag is sent as a message.</p><img src=/img/shehacks-hackfest-2021/kernel18.png class=center style=border-radius:8px><p>Flag: <code>Hackfest{Howdy Friend}</code></p><h3 id=2-hardcoded>2. Hardcoded<a href=#2-hardcoded class=hanchor arialabel=Anchor>&#8983;</a></h3><img src=/img/shehacks-hackfest-2021/kernel19.png class=center style=border-radius:8px><p>The provided zip file has only two files inside.</p><img src=/img/shehacks-hackfest-2021/kernel20.png class=center style=border-radius:8px><p>The config.php is somewhat encrypted.</p><p>Using this google search I found an article with the decryption method.</p><img src=/img/shehacks-hackfest-2021/kernel21.png class=center style=border-radius:8px><pre tabindex=0><code>https://blog.securityevaluators.com/terramaster-nas-vulnerabilities-discovered-and-exploited-b8e5243e7a63
</code></pre><p>By running the below command we can get the email from the config.php</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>openssl aes-256-cbc -d -K <span style=color:#ae81ff>3834326434326239383837366635383166306466626566623063643262356333</span> -iv <span style=color:#ae81ff>0</span> -in config.php &gt; config.php.out
</span></span></code></pre></div><img src=/img/shehacks-hackfest-2021/kernel22.png class=center style=border-radius:8px><p>Flag: <code>Hackfest{kalcaddle@qq.com}</code></p><h2 id=conclusion>Conclusion<a href=#conclusion class=hanchor arialabel=Anchor>&#8983;</a></h2><p>This was a nice CTF with some not so common categories. Playing with dd was a learning process for me, I haven&rsquo;t used it much before.</p><p>Here are the challenge files incase the CTF site goes down.</p><p><a href=https://blog.ikuamike.io/files/shehacks-hackfest-2021/demo.zip target=_blank rel=noopener>demo.zip</a></p><p><a href=https://blog.ikuamike.io/files/shehacks-hackfest-2021/terramaster.zip target=_blank rel=noopener>terramaster.zip</a></p></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=https://blog.ikuamike.io/posts/2021/metasploit_ctf_2021/><span class=button__icon>←</span>
<span class=button__text>Metasploit Community CTF 2021 WriteUp</span></a></span>
<span class="button next"><a href=https://blog.ikuamike.io/posts/2021/africahackon-2021-ctf-finals/><span class=button__text>AfricaHackon 2021 CTF Finals WriteUp</span>
<span class=button__icon>→</span></a></span></div></div></article></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2024 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: <a href=https://github.com/panr/hugo-theme-terminal target=_blank>Theme</a> made by <a href=https://github.com/panr target=_blank>panr</a></span></div></div></footer><script type=text/javascript src=/bundle.min.js></script></div><script src=/js/vanilla-back-to-top.min.js></script>
<script>addBackToTop({diameter:40,backgroundColor:"rgb(120, 226, 160)",textColor:"#1F222A",cornerOffset:30})</script><script src=/js/particles.min.js></script>
<script>particlesJS("particles-js",{particles:{number:{value:80,density:{enable:!0,value_area:1e3}},color:{value:"#ffffff"},shape:{type:"circle",stroke:{width:0,color:"#000000"}},opacity:{value:.5,random:!1,anim:{enable:!1,speed:1,opacity_min:.1,sync:!1}},size:{value:2,random:!0,anim:{enable:!1,speed:4,size_min:.1,sync:!1}},line_linked:{enable:!0,distance:150,color:"#ffffff",opacity:.3,width:1},move:{enable:!0,speed:.5,direction:"none",random:!0,straight:!1,out_mode:"out",bounce:!1,attract:{enable:!1,rotateX:600,rotateY:1200}}},retina_detect:!0})</script></body></html>