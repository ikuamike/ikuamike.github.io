<!doctype html><html lang=en><head><title>AfricaHackon 2021 CTF Finals WriteUp :: ikuamike</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content=","><meta name=robots content="noodp"><link rel=canonical href=https://blog.ikuamike.io/posts/2021/africahackon-2021-ctf-finals/><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-202973704-2','auto'),ga('send','pageview'))</script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-202973704-2','auto'),ga('send','pageview'))</script><script async src=https://www.google-analytics.com/analytics.js></script><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.ikuamike.io/img/ahfinals2021/ahctf1.jpg"><meta name=twitter:title content="AfricaHackon 2021 CTF Finals WriteUp"><meta name=twitter:description content><meta name=twitter:site content="@ikuamike"><link rel=stylesheet href=https://blog.ikuamike.io/assets/style.css><link rel=stylesheet href=https://blog.ikuamike.io/assets/green.css><link rel=stylesheet href=https://blog.ikuamike.io/style.css><link rel=apple-touch-icon href=https://blog.ikuamike.io/img/apple-touch-icon-192x192.png><link rel="shortcut icon" href=https://blog.ikuamike.io/img/favicon/green.png><meta name=twitter:card content="summary_large_image"><meta name=twitter:creator content="@ikuamike"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="AfricaHackon 2021 CTF Finals WriteUp"><meta property="og:description" content><meta property="og:url" content="https://blog.ikuamike.io/posts/2021/africahackon-2021-ctf-finals/"><meta property="og:site_name" content="ikuamike"><meta property="og:image" content="https://blog.ikuamike.io/"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:published_time" content="2021-11-09 00:00:00 +0000 UTC"></head><body class=green><div class="container center headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>> cd ~</div></a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/about>About Me</a></li><li><a href=/all-posts>All Posts</a></li><li><a href=/tags>Tags</a></li><ul class=menu__sub-inner><li class=menu__sub-inner-more-trigger>Show more ▾</li><ul class="menu__sub-inner-more hidden"><li><a href=/webinars>Webinars</a></li></ul></ul></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/about>About Me</a></li><li><a href=/all-posts>All Posts</a></li><li><a href=/tags>Tags</a></li><li><a href=/webinars>Webinars</a></li></ul></nav></header><div class=content><div class=post><h1 class=post-title><a href=https://blog.ikuamike.io/posts/2021/africahackon-2021-ctf-finals/>AfricaHackon 2021 CTF Finals WriteUp</a></h1><div class=post-meta><span class=post-date>2021-11-09</span></div><span class=post-tags>#<a href=https://blog.ikuamike.io/tags/ctf/>CTF</a>&nbsp;</span><div class=table-of-contents><h2>Table of Contents</h2><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#challenges>Challenges</a><ul><li><a href=#1-processing>1. Processing</a></li><li><a href=#2-phished>2. Phished</a></li></ul></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div><div class=post-content><div><img src=/img/ahfinals2021/ahctf1.jpg class=center style=border-radius:8px><h2 id=introduction>Introduction<a href=#introduction class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Last week <a href=https://twitter.com/mystic_kev target=_blank rel=noopener>@mystic_kev</a>
and I participated in the AfricaHackon 2021 CTF finals as team NoPwnNoGain, we managed position 4.
We were able to solve 3 challenges with first blood on 2 of them. This writeup demonstrates how I was able to solve one of them.</p><h2 id=challenges>Challenges<a href=#challenges class=hanchor arialabel=Anchor>&#8983;</a></h2><h3 id=1-processing>1. Processing<a href=#1-processing class=hanchor arialabel=Anchor>&#8983;</a></h3><p>Challenge description:</p><img src=/img/ahfinals2021/processing.png class=center style=border-radius:8px><p>For this challenge we are provided a zip file with the java apps for the challenge.</p><img src=/img/ahfinals2021/processing2.png class=center style=border-radius:8px><p>The Challenge file is a shell script that allows for executing the challenge easily. On executing it we get a gui app.</p><img src=/img/ahfinals2021/processing3.png class=center style=border-radius:8px><p>When we supply the wrong password we get access denied.</p><img src=/img/ahfinals2021/processing4.png class=center style=border-radius:8px><p>Since this are jar files we can decrypt them using jadx-gui. I&rsquo;ll focus on the Challenge.jar file as it&rsquo;s the entrypoint
of the challenge. From jadx-gui we can spot the functions responsible for the input interface and for checking the password.</p><img src=/img/ahfinals2021/processing5.png class=center style=border-radius:8px><p>The next logical step would be to reverse engineer the code and build the flag from there. If you would like to see how that
approach would have been done see these writeups.</p><p><a href=https://lvmalware.github.io/writeup/2021/11/06/Africahackon-Finals.html target=_blank rel=noopener>https://lvmalware.github.io/writeup/2021/11/06/Africahackon-Finals.html</a></p><p><a href=https://trevorsaudi.medium.com/africahackon-2021-ctf-finals-8111f8edc408 target=_blank rel=noopener>https://trevorsaudi.medium.com/africahackon-2021-ctf-finals-8111f8edc408</a></p><p>I used a different approach that I learnt from another ctf that I would like to share.</p><p>By using a tool called <a href=https://github.com/Col-E/Recaf target=_blank rel=noopener>recaf</a>
we can edit the application&rsquo;s code and repackage it again to run
our modified code. This means that we can utilize the existing functions and classes in the application to achieve our goal.</p><img src=/img/ahfinals2021/processing6.png class=center style=border-radius:8px><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>boolean</span> <span style=color:#a6e22e>checkPW</span><span style=color:#f92672>(</span>String pw<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
        ArrayList<span style=color:#f92672>&lt;</span>Character<span style=color:#f92672>&gt;</span> output <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ArrayList<span style=color:#f92672>&lt;</span>Character<span style=color:#f92672>&gt;();</span>
        <span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span>
        <span style=color:#66d9ef>while</span> <span style=color:#f92672>(</span>i <span style=color:#f92672>&lt;</span> <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>s_key</span><span style=color:#f92672>.</span><span style=color:#a6e22e>length</span><span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
            <span style=color:#66d9ef>char</span> test <span style=color:#f92672>=</span> PApplet<span style=color:#f92672>.</span><span style=color:#a6e22e>parseChar</span><span style=color:#f92672>(</span>Challenge<span style=color:#f92672>.</span><span style=color:#a6e22e>unhex</span><span style=color:#f92672>(</span><span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>s_key</span><span style=color:#f92672>[</span>i<span style=color:#f92672>]));</span>
            output<span style=color:#f92672>.</span><span style=color:#a6e22e>add</span><span style=color:#f92672>(</span>test<span style=color:#f92672>);</span>
            <span style=color:#f92672>++</span>i<span style=color:#f92672>;</span>
        <span style=color:#f92672>}</span>
        System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>println</span><span style=color:#f92672>(</span>output<span style=color:#f92672>);</span>
        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>true</span><span style=color:#f92672>;</span>

    <span style=color:#f92672>}</span>
</code></pre></div><p>I edited the checkPW function as shown above, and then saved the new Challenge.jar by exporting it.</p><pre><code>File -&gt; Export Program
</code></pre><p>With our Challenge.jar modified we can run the challenge and get the flag. Also I am not so good with java so I let the output appear as an array
then cleaned it up manually.</p><img src=/img/ahfinals2021/processing7.png class=center style=border-radius:8px><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>flag<span style=color:#f92672>{</span>Processing_1s_a_c00l_Pr0gramm1ng_language<span style=color:#f92672>}</span>
</code></pre></div><h3 id=2-phished>2. Phished<a href=#2-phished class=hanchor arialabel=Anchor>&#8983;</a></h3><p>I was to solve phished and get <strong>first blood</strong> but I followed John Hammond&rsquo;s video on a previous ctf that solved this similar challenge so I&rsquo;ll just link it
as the explanation is good enough. Only difference is I used <a href=https://gchq.github.io/CyberChef/ target=_blank rel=noopener>cyberchef</a>
for find and replace to clean up the output
from the xls instead of an editor.</p><p><a href=https://youtu.be/QgHhgwKL79Q target=_blank rel=noopener>https://youtu.be/QgHhgwKL79Q</a></p><p><a href=https://twitter.com/trevorsaudi target=_blank rel=noopener>@trevorsaudi</a>
also shows how to solve this in his writeup.</p><pre><code>https://trevorsaudi.medium.com/africahackon-2021-ctf-finals-8111f8edc408
</code></pre><h2 id=conclusion>Conclusion<a href=#conclusion class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Thanks to <a href=https://twitter.com/AfricaHackon target=_blank rel=noopener>@AfricaHackon</a>
and the partners for the CTF, we don&rsquo;t get to play many locally organised ctfs so this was good to compete against local teams.</p><p>You can still play the challenges by visiting this link <a href=https://ctfroom.com/vaults/ target=_blank rel=noopener>https://ctfroom.com/vaults/</a></p></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button next"><a href=https://blog.ikuamike.io/posts/2021/hacktivitycon-2021-ctf/><span class=button__text>H@cktivityCon 2021 CTF Writeup</span>
<span class=button__icon>→</span></a></span></div></div></div></div><footer class=footer><div class=footer__inner><div class="copyright copyright--user"><span>© Michael Ikua</span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script src=https://blog.ikuamike.io/assets/main.js></script><script src=https://blog.ikuamike.io/assets/prism.js></script></div><script src=https://unpkg.com/vanilla-back-to-top@7.2.1/dist/vanilla-back-to-top.min.js></script><script>addBackToTop({diameter:40,backgroundColor:'rgb(120, 226, 160)',textColor:'#1F222A',cornerOffset:30})</script></body></html>